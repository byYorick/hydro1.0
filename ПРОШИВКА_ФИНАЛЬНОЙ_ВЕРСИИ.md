# üöÄ –ü—Ä–æ—à–∏–≤–∫–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Å–æ –≤—Å–µ–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏

**–î–∞—Ç–∞:** 2025-10-16  
**–í–µ—Ä—Å–∏—è:** 3.0.0-advanced-fixed  

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û!

–¢–µ–∫—É—â–∏–µ –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç **–°–¢–ê–†–£–Æ –ø—Ä–æ—à–∏–≤–∫—É** (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)!

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**
1. ‚ùå –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π `"Sensor X disabled until..."` ‚Üí auto-disable –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚ùå I2C –æ—à–∏–±–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–π —Ü–∏–∫–ª ‚Üí —Å—Ç–∞—Ä—ã–π –∫–æ–¥
3. ‚ùå LVGL mutex contention –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è ‚Üí —Å—Ç–∞—Ä—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

---

## ‚úÖ –ß–¢–û –í –ù–û–í–û–ô –ü–†–û–®–ò–í–ö–ï

### 1. Sensor Manager - Auto-disable:
```
‚úÖ –ü–æ—Å–ª–µ 10 –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥ ‚Üí –¥–∞—Ç—á–∏–∫ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ 60 —Å–µ–∫
‚úÖ –û–¥–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Å–æ—Ç–µ–Ω –æ—à–∏–±–æ–∫
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 60 —Å–µ–∫
```

### 2. LVGL Task - Priority 7:
```
‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–≤—ã—à–µ–Ω —Å 2 –¥–æ 7
‚úÖ –ù–µ –≤—ã—Ç–µ—Å–Ω—è–µ—Ç—Å—è Display/Encoder
‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –º—å—é—Ç–µ–∫—Å
```

### 3. LVGL Task - Watchdog:
```
‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ watchdog
‚úÖ –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç WDT –¥–æ/–ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è –º—å—é—Ç–µ–∫—Å–∞
```

### 4. SPI - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
```
‚úÖ –û—á–µ—Ä–µ–¥—å 30 –≤–º–µ—Å—Ç–æ 10
‚úÖ Max transfer 48 KB –≤–º–µ—Å—Ç–æ 38 KB
‚úÖ –ë—É—Ñ–µ—Ä—ã 40 —Å—Ç—Ä–æ–∫ –≤–º–µ—Å—Ç–æ 60
```

### 5. Display Task - Timeout:
```
‚úÖ Timeout 500 –º—Å –≤–º–µ—Å—Ç–æ 100 –º—Å
‚úÖ –£—Å–ø–µ–≤–∞–µ—Ç –¥–æ–∂–¥–∞—Ç—å—Å—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –º—å—é—Ç–µ–∫—Å–∞
```

### 6. Notifications - Queue:
```
‚úÖ –û—á–µ—Ä–µ–¥—å 20 –≤–º–µ—Å—Ç–æ 5
‚úÖ –ù–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è–µ—Ç—Å—è
```

---

## üéØ –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ü–†–û–®–ò–í–ö–ò

### –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –º–æ–Ω–∏—Ç–æ—Ä
–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä –Ω–∞–∂–º–∏—Ç–µ: **`Ctrl+C`**

### –®–∞–≥ 2: –ü—Ä–æ—à–µ–π—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
```bash
idf.py -p COM5 flash monitor
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò (–ù–û–í–ê–Ø –ø—Ä–æ—à–∏–≤–∫–∞)

### –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:

```
I (xxx) LCD: Display buffer 1 allocated in PSRAM: 19200 bytes (40 lines)
I (xxx) LCD: Display buffer 2 allocated in PSRAM: 19200 bytes (40 lines)
I (xxx) LCD: LVGL task registered in watchdog  ‚Üê –ù–û–í–û–ï! ‚úÖ
I (xxx) HYDRO_MAIN: [OK] Network Manager initialized
I (xxx) NETWORK: WiFi connected! IP: xxx.xxx.xxx.xxx
```

### –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞–º–∏:

```
W (10000) SENSOR_MGR: Sensor 0 disabled until 70000 ms (too many errors) ‚Üê –ù–û–í–û–ï! ‚úÖ
W (10000) SENSOR_MGR: Sensor 3 disabled until 70000 ms (too many errors) ‚Üê –ù–û–í–û–ï! ‚úÖ
W (10000) SENSOR_MGR: Sensor 4 disabled until 70000 ms (too many errors) ‚Üê –ù–û–í–û–ï! ‚úÖ

(60 —Å–µ–∫—É–Ω–¥ —Ç–∏—à–∏–Ω—ã - –¥–∞—Ç—á–∏–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã)

W (70000) SENSOR_MGR: Sensor 0 disabled until 130000 ms (too many errors)
(–ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫ –≤–º–µ—Å—Ç–æ —Å–æ—Ç–µ–Ω —Ä–∞–∑ –≤ —Å–µ–∫—É–Ω–¥—É)
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ LVGL:

```
W (xxx) LCD: LVGL held mutex for 450 ms (blocking Display task!) ‚Üê –ù–û–í–û–ï! ‚úÖ
(–µ—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ ‚Üí –∑–Ω–∞—á–∏—Ç –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–µ–∞–ª—å–Ω–æ –¥–æ–ª–≥–∞—è)
```

### ‚ùå –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å (—Å—Ç–∞—Ä–∞—è –ø—Ä–æ—à–∏–≤–∫–∞):

```
‚ùå –°–æ—Ç–Ω–∏ I2C –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
‚ùå "task watchdog got triggered" –∫–∞–∂–¥—ã–µ 5-10 —Å–µ–∫—É–Ω–¥
‚ùå "task not found" –¥–ª—è esp_task_wdt_reset
```

---

## üîç –ö–ê–ö –û–ü–†–ï–î–ï–õ–ò–¢–¨ –ß–¢–û –ü–†–û–®–ò–í–ö–ê –û–ë–ù–û–í–ò–õ–ê–°–¨

### –ü—Ä–∏–∑–Ω–∞–∫–∏ –ù–û–í–û–ô –ø—Ä–æ—à–∏–≤–∫–∏:

1. ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ: `"LVGL task registered in watchdog"`
2. ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è: `"Sensor X disabled until..."`
3. ‚úÖ I2C –æ—à–∏–±–∫–∏ –ø—Ä–µ–∫—Ä–∞—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 10 –ø–æ–ø—ã—Ç–æ–∫
4. ‚úÖ –ù–µ—Ç watchdog timeout –Ω–∞ LVGL
5. ‚úÖ –ù–µ—Ç –º–∞—Å—Å–æ–≤—ã—Ö "Failed to get LVGL lock"

### –ü—Ä–∏–∑–Ω–∞–∫–∏ –°–¢–ê–†–û–ô –ø—Ä–æ—à–∏–≤–∫–∏:

1. ‚ùå –ù–µ—Ç "LVGL task registered in watchdog"
2. ‚ùå I2C –æ—à–∏–±–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
3. ‚ùå Watchdog timeout –∫–∞–∂–¥—ã–µ 5-10 —Å–µ–∫
4. ‚ùå "Failed to get LVGL lock" –∫–∞–∂–¥—ã–µ 600 –º—Å

---

## üìù –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–ë–û–†–ö–ê

```
–†–∞–∑–º–µ—Ä: 1.32 MB
–†–∞–∑–¥–µ–ª: 3.83 MB
–°–≤–æ–±–æ–¥–Ω–æ: 2.6 MB (66%)
DRAM: 266 KB (77.8%)
–°–≤–æ

–±–æ–¥–Ω–æ DRAM: 76 KB
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –°–æ–±—Ä–∞–Ω–æ, –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ—à–∏–≤–∫–µ!

---

## üéØ –î–ï–ô–°–¢–í–ò–Ø –°–ï–ô–ß–ê–°

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä:** `Ctrl+C`
2. **–ü—Ä–æ—à–µ–π—Ç–µ:**
   ```bash
   idf.py -p COM5 flash monitor
   ```
3. **–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏** - –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ù–û–í–´–ï —Å–æ–æ–±—â–µ–Ω–∏—è!

---

**–ü—Ä–æ—à–∏–≤–∞–π—Ç–µ! –≠—Ç–æ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–æ –í–°–ï–ú–ò –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏!** üöÄ

