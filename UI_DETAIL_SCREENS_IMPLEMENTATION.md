# Реализация экранов детализации параметров

## Обзор

Реализована система детализации параметров с экранами настроек для каждой панели сенсоров. Система включает навигацию между экранами, мини-графики, отображение текущих и установленных значений, а также экраны настроек с заглушками.

## Структура экранов

### 1. Главный экран (SCREEN_MAIN)
- Сетка из 6 карточек сенсоров
- При клике на карточку открывается экран детализации

### 2. Экраны детализации (SCREEN_DETAIL_*)
Для каждого сенсора (pH, EC, Temperature, Humidity, Lux, CO2):
- **Заголовок** с названием параметра
- **Кнопка "Назад"** (←) в правом верхнем углу
- **Мини-график** (280x120px) с последними 20 точками данных
- **Текущее значение** с единицами измерения
- **Установленное значение** (среднее между warn_low и warn_high)
- **Кнопка "Settings"** внизу экрана

### 3. Экраны настроек (SCREEN_SETTINGS_*)
Для каждого сенсора:
- **Заголовок** с названием параметра + "Settings"
- **Кнопка "Назад"** (←) в правом верхнем углу
- **Список настроек** (заглушки):
  - Calibration
  - Alarm Thresholds
  - Update Interval
  - Display Units
  - Data Logging

## Навигация

### Переходы между экранами:
1. **Главный экран** → **Экран детализации** (клик по карточке сенсора)
2. **Экран детализации** → **Экран настроек** (клик по кнопке "Settings")
3. **Экран настроек** → **Экран детализации** (клик по кнопке "Назад")
4. **Экран детализации** → **Главный экран** (клик по кнопке "Назад")

## Технические детали

### Структуры данных:
```c
typedef enum {
    SCREEN_MAIN = 0,
    SCREEN_DETAIL_PH,
    SCREEN_DETAIL_EC,
    SCREEN_DETAIL_TEMP,
    SCREEN_DETAIL_HUMIDITY,
    SCREEN_DETAIL_LUX,
    SCREEN_DETAIL_CO2,
    SCREEN_SETTINGS_PH,
    SCREEN_SETTINGS_EC,
    SCREEN_SETTINGS_TEMP,
    SCREEN_SETTINGS_HUMIDITY,
    SCREEN_SETTINGS_LUX,
    SCREEN_SETTINGS_CO2,
    SCREEN_COUNT
} screen_type_t;

typedef struct {
    lv_obj_t *screen;
    lv_obj_t *chart;
    lv_obj_t *current_value_label;
    lv_obj_t *set_value_label;
    lv_obj_t *settings_btn;
    lv_obj_t *back_btn;
    uint8_t sensor_index;
} detail_screen_t;

typedef struct {
    lv_obj_t *screen;
    lv_obj_t *back_btn;
    lv_obj_t *settings_list;
    uint8_t sensor_index;
} settings_screen_t;
```

### Ключевые функции:
- `sensor_card_event_cb()` - обработчик клика по карточке сенсора
- `create_detail_screen()` - создание экрана детализации
- `create_settings_screen()` - создание экрана настроек
- `show_screen()` - переключение между экранами
- `back_button_event_cb()` - обработчик кнопки "Назад"
- `settings_button_event_cb()` - обработчик кнопки "Settings"

### Обновление данных:
- Текущие значения обновляются в реальном времени
- Графики получают новые точки данных при каждом обновлении
- Установленные значения рассчитываются как среднее между warn_low и warn_high

## Особенности реализации

1. **Ленивая инициализация**: Экраны создаются только при первом обращении
2. **Управление памятью**: Экраны скрываются/показываются, а не удаляются
3. **Совместимость**: Сохранена совместимость с существующим кодом
4. **Стилизация**: Используются существующие стили LVGL
5. **Масштабируемость**: Легко добавить новые сенсоры

## Статус

✅ **Завершено:**
- Создание экранов детализации
- Мини-графики
- Отображение текущих и установленных значений
- Кнопки настроек и назад
- Экраны настроек с заглушками
- Навигация между экранами
- Обновление данных в реальном времени

⏳ **В процессе:**
- Навигация энкодером (требует интеграции с компонентом encoder)

## Использование

1. Соберите проект: `idf.py build`
2. Загрузите на устройство: `idf.py flash`
3. При клике на любую карточку сенсора откроется экран детализации
4. На экране детализации можно перейти к настройкам
5. Кнопка "Назад" возвращает на предыдущий экран
