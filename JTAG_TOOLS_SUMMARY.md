# üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å ESP32-S3 —á–µ—Ä–µ–∑ JTAG

**–î–∞—Ç–∞:** 2025-10-09  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é ‚úÖ

---

## üì¶ –°–û–ó–î–ê–ù–ù–´–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢–´

### 1. üîç **–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è** - `analyze_esp32_state.py`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–º–ø —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (PC)
- –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–µ–∫–∞ (SP)
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –ø—Ä–∏—á–∏–Ω—ã –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python analyze_esp32_state.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –ø–æ PC
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å—Ç–µ–∫–∞
- ‚úÖ –î–µ–∫–æ–¥–∏—Ä—É–µ—Ç –ø—Ä–∏—á–∏–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤

---

### 2. üíæ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á—Ç–µ—Ü –ø–∞–º—è—Ç–∏** - `read_esp32_memory.py`
–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è ESP32-S3.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python read_esp32_memory.py
```

**–ú–µ–Ω—é:**
1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∏–ø–µ
2. –†–µ–≥–∏—Å—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
3. RAM (DRAM)
4. IRAM
5. –î–∞–º–ø Flash
6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–∏–ø–∞
7. –ó–∞–ø—É—Å–∫ —á–∏–ø–∞
8. –°–≤–æ—è –∫–æ–º–∞–Ω–¥–∞ OpenOCD
9. –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å

---

### 3. üìä **GDB Backtrace** - `gdb_backtrace.bat`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ —á–µ—Ä–µ–∑ GDB.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
gdb_backtrace.bat
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ó–∞–ø—É—Å–∫–∞–µ—Ç OpenOCD
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ GDB
- –ü–æ–ª—É—á–∞–µ—Ç backtrace
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä—ã
- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á FreeRTOS

---

### 4. üìã **–ß—Ç–µ–Ω–∏–µ —Å—Ç–µ–∫–∞** - `read_stack.bat`
–ë—ã—Å—Ç—Ä–æ–µ —á—Ç–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ –ø–æ —Ç–µ–∫—É—â–µ–º—É SP.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
read_stack.bat
```

**–í—ã–≤–æ–¥–∏—Ç:**
- 128 —Å–ª–æ–≤ –∏–∑ —Å—Ç–µ–∫–∞
- –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã (PC, A0, A1)

---

### 5. ‚ö° **–ü—Ä–æ—à–∏–≤–∫–∞ —á–µ—Ä–µ–∑ JTAG** - `flash_jtag.bat`
–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ—à–∏–≤–∫–∞ –±–µ–∑ COM –ø–æ—Ä—Ç–∞.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
flash_jtag.bat
```

---

### 6. üîÑ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π JTAG** - `jtag_interactive.bat`
–ó–∞–ø—É—Å–∫–∞–µ—Ç OpenOCD —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
jtag_interactive.bat
```

–ó–∞—Ç–µ–º –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
telnet localhost 4444
```

---

### 7. üìñ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —á—Ç–µ–Ω–∏–µ** - `read_jtag.bat`
–ë—ã—Å—Ç—Ä—ã–π –¥–∞–º–ø –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∏–ø–µ.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
read_jtag.bat
```

---

## üéØ –°–¶–ï–ù–ê–†–ò–ò –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### üîç –°—Ü–µ–Ω–∞—Ä–∏–π 1: "–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å —á–∏–ø–æ–º?"

```bash
# –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –¥–∞–º–ø —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
python read_esp32_memory.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 2 (–†–µ–≥–∏—Å—Ç—Ä—ã)

# –®–∞–≥ 2: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ
python analyze_esp32_state.py

# –®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç–µ backtrace
gdb_backtrace.bat
```

---

### üêõ –°—Ü–µ–Ω–∞—Ä–∏–π 2: "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–ª–∞"

```bash
# –®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —á–∏–ø
python read_esp32_memory.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 6 (–û—Å—Ç–∞–Ω–æ–≤–∫–∞)

# –®–∞–≥ 2: –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Å—Ç–µ–∫
read_stack.bat

# –®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç–µ backtrace
gdb_backtrace.bat

# –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ
python read_esp32_memory.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 7 (–ó–∞–ø—É—Å–∫)
```

---

### üíæ –°—Ü–µ–Ω–∞—Ä–∏–π 3: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–º–ø –ø–∞–º—è—Ç–∏"

```bash
python read_esp32_memory.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 5 (–î–∞–º–ø Flash)
# –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ flash_bootloader.bin

# –ò–ª–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–∞–º–ø–∞:
# –í—ã–±–µ—Ä–∏—Ç–µ: 8 (–°–≤–æ—è –∫–æ–º–∞–Ω–¥–∞)
# –í–≤–µ–¥–∏—Ç–µ: flash read_bank 0 full_dump.bin 0 0x1000000
```

---

### üîß –°—Ü–µ–Ω–∞—Ä–∏–π 4: "–û—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏"

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ OpenOCD
jtag_interactive.bat

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ GDB
xtensa-esp32s3-elf-gdb build/hydroponics.elf

# –í GDB:
(gdb) target remote localhost:3333
(gdb) monitor reset halt
(gdb) b app_main           # Breakpoint –Ω–∞ app_main
(gdb) c                    # Continue
(gdb) bt                   # Backtrace
(gdb) info locals          # –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

---

## üìù –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê –í–ê–®–ï–ì–û –î–ê–ú–ü–ê

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
```
PC = 0x40056F62  [ROM Boot]
SP = 0x3FCEB1F0  [DRAM - OK]
DEBUGCAUSE = 0x20 [–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –æ—Ç–ª–∞–¥—á–∏–∫–æ–º]
EXCCAUSE = 0x00  [–ù–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π]
```

### –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è:
- ‚úÖ Timer (bit 6)
- ‚úÖ WiFi MAC (bit 15)
- ‚úÖ WiFi BB (bit 16)

### –í—ã–≤–æ–¥:
–ß–∏–ø –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Boot ROM. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –µ—Å–ª–∏:
1. –¢–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–ø—É—â–µ–Ω
2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –∏–∑ ROM
3. –ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ bootloader

---

## üöÄ –†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

### –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–Ω—è—Ç—å –≥–¥–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞:
```bash
gdb_backtrace.bat
```

### –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
```bash
python read_esp32_memory.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 7 (–ó–∞–ø—É—Å–∫ —á–∏–ø–∞)
```

### –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å breakpoint –Ω–∞ app_main:
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1:
jtag_interactive.bat

# –¢–µ—Ä–º–∏–Ω–∞–ª 2:
xtensa-esp32s3-elf-gdb build/hydroponics.elf
(gdb) target remote localhost:3333
(gdb) monitor reset halt
(gdb) b app_main
(gdb) c
```

---

## üìö –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

- **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ JTAG:** `JTAG_SETUP_GUIDE.md`
- **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —á—Ç–µ–Ω–∏—é:** `JTAG_READ_GUIDE.md`
- **–ö–æ–º–∞–Ω–¥—ã OpenOCD:** –°–º. `JTAG_READ_GUIDE.md` —Ä–∞–∑–¥–µ–ª "–ö–æ–º–∞–Ω–¥—ã"

---

## ‚öôÔ∏è –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

**–•–æ—Ç–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ —Å —á–∏–ø–æ–º?**
```bash
python read_esp32_memory.py
# –í—ã–±–µ—Ä–∏—Ç–µ: 1 (–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∏–ø–µ)
```

**–ù—É–∂–µ–Ω backtrace?**
```bash
gdb_backtrace.bat
```

**–•–æ—Ç–∏—Ç–µ –ø—Ä–æ—à–∏—Ç—å —á–µ—Ä–µ–∑ JTAG?**
```bash
flash_jtag.bat
```

**–ù—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø?**
```bash
jtag_interactive.bat
# –ó–∞—Ç–µ–º: telnet localhost 4444
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

–í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç! ‚ú®

–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:
- ‚úÖ `analyze_esp32_state.py` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ `read_esp32_memory.py` - –≥–æ—Ç–æ–≤
- ‚úÖ `gdb_backtrace.bat` - –≥–æ—Ç–æ–≤
- ‚úÖ `read_stack.bat` - –≥–æ—Ç–æ–≤
- ‚úÖ `flash_jtag.bat` - –≥–æ—Ç–æ–≤
- ‚úÖ `jtag_interactive.bat` - –≥–æ—Ç–æ–≤

---

## üéâ –ì–û–¢–û–í–û!

–í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤—ã—à–µ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
python read_esp32_memory.py
```

–î–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å ESP32-S3 —á–µ—Ä–µ–∑ JTAG! üöÄ

