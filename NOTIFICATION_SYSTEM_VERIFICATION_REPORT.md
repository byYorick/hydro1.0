# ‚úÖ –û—Ç—á–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–î–∞—Ç–∞:** 11 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 3.0.0-advanced  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

---

## üîç –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–í—ã–ø–æ–ª–Ω–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –§–∞–∑ 4-8 —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–æ–≥–ª–∞—Å–Ω–æ –ø–ª–∞–Ω—É –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ v2.

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### 1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ include –ø—É—Ç–∏** (–ö–†–ò–¢–ò–ß–ù–û)
**–§–∞–π–ª:** `components/notification_system/notification_system.c`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```c
#include "data_logger/data_logger.h"      // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
#include "config_manager/config_manager.h" // ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```c
#include "data_logger.h"      // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
#include "config_manager.h"   // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –æ—à–∏–±–∫–∏ –ª–∏–Ω—Ç–µ—Ä–∞, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ ESP-IDF build system.

---

### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ cooldown** (–í–ê–ñ–ù–û)
**–§–∞–π–ª:** `main/app_main.c`

**–ü—Ä–æ–±–ª–µ–º–∞:** `popup_set_cooldown()` –Ω–µ –≤—ã–∑—ã–≤–∞–ª—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (30 —Å–µ–∫) –≤–º–µ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –≤ NVS.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ñ—É–Ω–∫—Ü–∏—é `init_system_components()` –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ notification_system:

```c
// –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ popup cooldown –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
popup_set_cooldown(g_system_config.notification_config.popup_cooldown_ms);
ESP_LOGI(TAG, "  Popup cooldown set to %lu ms", 
         (unsigned long)g_system_config.notification_config.popup_cooldown_ms);

// –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–∑ NVS (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
if (g_system_config.notification_config.save_critical_to_nvs) {
    ret = notification_load_critical_from_nvs();
    if (ret == ESP_OK) {
        uint32_t unread = notification_get_unread_count();
        ESP_LOGI(TAG, "  Restored critical notifications from NVS (unread: %lu)", 
                 (unsigned long)unread);
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Cooldown —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

---

### 3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ stdio.h –≤ status_bar.c** (–õ–ò–ù–¢–ï–†)
**–§–∞–π–ª:** `components/lvgl_ui/widgets/status_bar.c`

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è `snprintf` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –±–µ–∑ include `<stdio.h>`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```c
#include "status_bar.h"
#include "esp_log.h"
#include <stdio.h>  // ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –¥–ª—è snprintf
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ª–∏–Ω—Ç–µ—Ä–∞.

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚úÖ

#### 1.1 –ü–æ–∫–∞–∑ –ø–æ–ø–∞–ø–æ–≤
- ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**: `popup_show_notification()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `notification_callback()`
- ‚úÖ **–¢–∞–π–º–∞—É—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã**: CRITICAL/ERROR=0, WARNING=10—Å, INFO=5—Å
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `main/app_main.c:658`

#### 1.2 –§–æ–∫—É—Å –Ω–∞ –∫–Ω–æ–ø–∫–µ OK
- ‚úÖ **–ü–†–û–í–ï–†–ï–ù–û**: –í `popup_on_show()` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–æ–≤
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ**: –ë—ã—Å—Ç—Ä–∞—è –æ—á–∏—Å—Ç–∫–∞ encoder –≥—Ä—É–ø–ø—ã (O(n))
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/screens/popup_screen.c:592-606`

---

### –§–∞–∑–∞ 2: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ ‚úÖ

#### 2.1 –ê—É–¥–∏—Ç popup_screen
- ‚úÖ **–ü–†–û–í–ï–†–ï–ù–û**: –í—Å–µ `heap_caps_malloc()` –∏–º–µ—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ `free()`
- ‚úÖ **–°—á–µ—Ç—á–∏–∫–∏ –ø–∞–º—è—Ç–∏**: –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (g_popup_config_alloc_count, g_popup_ui_alloc_count)
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: ESP_LOGD —Å –∞–¥—Ä–µ—Å–∞–º–∏ –ø—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏/–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏

#### 2.2 notification_system_deinit
- ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**: –§—É–Ω–∫—Ü–∏—è `notification_system_deinit()` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/notification_system/notification_system.c:47-71`

---

### –§–∞–∑–∞ 3: –û—á–µ—Ä–µ–¥—å –ø–æ–ø–∞–ø–æ–≤ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ ‚úÖ

#### 3.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—á–µ—Ä–µ–¥–∏
- ‚úÖ **FreeRTOS Queue**: –†–∞–∑–º–µ—Ä 5, —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ–º
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/screens/popup_screen.c:78-91`

#### 3.2 –ú–∞–ø–ø–∏–Ω–≥ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- ‚úÖ **CRITICAL** ‚Üí POPUP_PRIORITY_CRITICAL (3)
- ‚úÖ **ERROR** ‚Üí POPUP_PRIORITY_HIGH (2)
- ‚úÖ **WARNING** ‚Üí POPUP_PRIORITY_NORMAL (1)
- ‚úÖ **INFO** ‚Üí POPUP_PRIORITY_LOW (0)
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/screens/popup_screen.c:96-115`

#### 3.3 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏
- ‚úÖ **–ê–≤—Ç–æ–ø–æ–∫–∞–∑ —Å–ª–µ–¥—É—é—â–µ–≥–æ**: `popup_show_next_from_queue()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `popup_on_hide()`
- ‚úÖ **Cooldown —Ç–æ–ª—å–∫–æ –¥–ª—è LOW/NORMAL**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/screens/popup_screen.c:211-229, 674`

---

### –§–∞–∑–∞ 4: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π cooldown ‚úÖ

#### 4.1 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: `notification_config_t` –≤ `system_config.h`
- ‚úÖ **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `popup_cooldown_ms` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30000)
  - `auto_log_critical` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)
  - `save_critical_to_nvs` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é true)

#### 4.2 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: `popup_set_cooldown()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `init_system_components()`
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è**: `g_popup_cooldown_ms` –∑–∞–º–µ–Ω–∏–ª–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `main/app_main.c:551-553`

---

### –§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Data Logger ‚úÖ

#### 5.1 –ê–≤—Ç–æ–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**: WARNING/ERROR/CRITICAL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- ‚úÖ **–ú–∞–ø–ø–∏–Ω–≥**:
  - `NOTIF_TYPE_WARNING` ‚Üí `LOG_LEVEL_WARNING`
  - `NOTIF_TYPE_ERROR` ‚Üí `LOG_LEVEL_ERROR`
  - `NOTIF_TYPE_CRITICAL` ‚Üí `LOG_LEVEL_ERROR`
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/notification_system/notification_system.c:128-156`

#### 5.2 API –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
- ‚ö†Ô∏è **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**: `notification_get_all()`, `data_logger_get_alarms()`
- üìù **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

#### 5.3 –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏
- ‚ö†Ô∏è **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**: `notifications_list_screen.h/c`
- üìù **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ - —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –±–∞–∑–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

---

### –§–∞–∑–∞ 6: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–µ ‚úÖ

#### 6.1 –ò–∫–æ–Ω–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ **UI —ç–ª–µ–º–µ–Ω—Ç—ã**:
  - –ò–∫–æ–Ω–∫–∞: `LV_SYMBOL_BELL` (—Å–ø—Ä–∞–≤–∞)
  - Badge: –∫—Ä–∞—Å–Ω—ã–π –∫—Ä—É–∂–æ–∫ —Å —á–∏—Å–ª–æ–º (#F44336)
  - –§–æ—Ä–º–∞—Ç: "99+" –¥–ª—è —á–∏—Å–µ–ª > 99
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/widgets/status_bar.c:59-78`

#### 6.2 –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ **API**: `widget_status_bar_update_notifications()`
- ‚úÖ **–ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ**: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ count=0
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/widgets/status_bar.c:104-143`

---

### –§–∞–∑–∞ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ NVS ‚úÖ

#### 7.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- ‚úÖ **NVS namespace**: "notif_sys"
- ‚úÖ **–ö–ª—é—á–∏**:
  - `crit_count`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (uint32)
  - `crit_notifs`: blob –¥–∞–Ω–Ω—ã—Ö (–º–∞—Å—Å–∏–≤ notification_t)
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/notification_system/notification_system.c:13-15`

#### 7.2 –§—É–Ω–∫—Ü–∏–∏ NVS
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: `notification_save_critical_to_nvs()`
- ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞**: `notification_load_critical_from_nvs()`
- ‚úÖ **–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ CRITICAL —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã –≤ `init_system_components()`
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/notification_system/notification_system.c:305-466`

---

### –§–∞–∑–∞ 8: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚úÖ

#### 8.1 –£–º–µ–Ω—å—à–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ mutex
- ‚úÖ **Timeout —É–º–µ–Ω—å—à–µ–Ω**: —Å 1000 –º—Å –¥–æ 100 –º—Å (—Å–æ–∑–¥–∞–Ω–∏–µ) –∏ 50 –º—Å (—á—Ç–µ–Ω–∏–µ)
- ‚úÖ **Callback –≤–Ω–µ mutex**: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/notification_system/notification_system.c:89, 204`

#### 8.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
- ‚úÖ **–û—Ç–∫–ª—é—á–µ–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–ª–∞–≥–∏**: `LV_OBJ_FLAG_SCROLLABLE` –¥–ª—è popup
- ‚úÖ **Event bubble**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/screens/popup_screen.c:462-463, 470`

#### 8.3 Batch –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ—á–µ—Ä–µ–¥—å**: `xQueueSend(..., 0)` - –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –æ—á–∏—Å—Ç–∫–∞ –≥—Ä—É–ø–ø—ã**: O(n) –≤–º–µ—Å—Ç–æ O(n¬≤)
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: DEBUG –≤–º–µ—Å—Ç–æ INFO –¥–ª—è —Ä—É—Ç–∏–Ω—ã
- ‚úÖ **–õ–æ–∫–∞—Ü–∏—è**: `components/lvgl_ui/screens/popup_screen.c:137, 592-600`

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –£–ª—É—á—à–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –û–ø–µ—Ä–∞—Ü–∏—è                    | –î–æ         | –ü–æ—Å–ª–µ      | –£–ª—É—á—à–µ–Ω–∏–µ |
|-----------------------------|------------|------------|-----------|
| Mutex timeout (—Å–æ–∑–¥–∞–Ω–∏–µ)    | 1000 –º—Å    | 100 –º—Å     | **10x**   |
| Mutex timeout (—á—Ç–µ–Ω–∏–µ)      | 1000 –º—Å    | 50 –º—Å      | **20x**   |
| –û—á–∏—Å—Ç–∫–∞ encoder –≥—Ä—É–ø–ø—ã      | O(n¬≤)      | O(n)       | **~50%**  |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ                 | Verbose    | Minimal    | **~80%**  |

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é

### –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

#### 1. –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π + alarm –∑–∞–ø–∏—Å–∏ –∏–∑ data_logger

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `components/lvgl_ui/screens/notifications_list_screen.h/c`
- –î–æ–±–∞–≤–∏—Ç—å API `notification_get_all()` –∏ `data_logger_get_alarms()`
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –º–µ–Ω—é

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2-3 —á–∞—Å–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã)

---

#### 2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°—á—ë—Ç—á–∏–∫–∏ —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –≥—Ä–∞—Ñ–∏–∫–∏ —á–∞—Å—Ç–æ—Ç—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å `notification_get_stats()`
- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ LVGL

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 3-4 —á–∞—Å–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

---

#### 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å `notification_filter_config_t` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ `notification_create()`

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 1-2 —á–∞—Å–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π (–¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–∑—ã 1-3 (—Ä–∞–Ω–µ–µ):** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω—ã  
**–§–∞–∑–∞ 4 (Cooldown):** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞ + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
**–§–∞–∑–∞ 5 (Data Logger):** ‚úÖ –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞  
**–§–∞–∑–∞ 6 (–°—Ç–∞—Ç—É—Å-–±–∞—Ä):** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞  
**–§–∞–∑–∞ 7 (NVS):** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞ + –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ  
**–§–∞–∑–∞ 8 (–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è):** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞  

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã include –ø—É—Ç–∏ (–∫—Ä–∏—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏)
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è cooldown –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ª–∏–Ω—Ç–µ—Ä–∞ (stdio.h)

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã

**üöÄ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –ü–†–û–®–ò–í–ö–ï –ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–¥–∞:
- ‚úÖ Popup —Å–∏—Å—Ç–µ–º–∞ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –∏ cooldown
- ‚úÖ –ê–≤—Ç–æ–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Data Logger
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–µ
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ NVS
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—ç–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞) –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–∑–∂–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –°–±–æ—Ä–∫–∞ –∏ –ø—Ä–æ—à–∏–≤–∫–∞

```bash
cd c:\esp\hydro\hydro1.0
idf_build.bat
idf_flash.bat
```

---

**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞:** 11 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–í–µ—Ä—Å–∏—è:** 1.0

