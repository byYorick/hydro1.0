# –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ COM5 –ø–æ—Ä—Ç–∞

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### 1. PowerShell —Å–∫—Ä–∏–ø—Ç (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
**–§–∞–π–ª:** `free_com5.ps1`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```powershell
# –° –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
powershell -ExecutionPolicy Bypass -File free_com5.ps1

# –ë–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
powershell -ExecutionPolicy Bypass -File free_com5.ps1 -Force
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö COM5
- ‚úÖ –ü–æ–∫–∞–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —Å PID –∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

### 2. BAT —Å–∫—Ä–∏–ø—Ç (–ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫)
**–§–∞–π–ª:** `free_com5.bat`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```cmd
free_com5.bat
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫ –¥–≤–æ–π–Ω—ã–º –∫–ª–∏–∫–æ–º
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –ü–∞—É–∑–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

### 3. –†—É—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

#### –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ COM5:
```cmd
wmic process where "commandline like '%%COM5%%' and (name='python.exe' or name='idf.py.exe')" get processid,name,commandline
```

#### –ó–∞–≤–µ—Ä—à–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ PID:
```cmd
taskkill /F /PID 1234 /PID 5678
```

#### –ó–∞–≤–µ—Ä—à–∏—Ç—å –≤—Å–µ Python –ø—Ä–æ—Ü–µ—Å—Å—ã —Å COM5:
```cmd
for /f "tokens=1" %a in ('wmic process where "commandline like '%%COM5%%' and name='python.exe'" get processid ^| findstr /R "[0-9]"') do @taskkill /F /PID %a
```

---

## üîß –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "COM5 is busy"
**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `free_com5.bat` –∏–ª–∏ `free_com5.ps1 -Force`
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-3 —Å–µ–∫—É–Ω–¥—ã
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ—à–∏—Ç—å —Å–Ω–æ–≤–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "Access Denied" –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
   ```powershell
   Start-Process powershell -Verb RunAs
   ```
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—Ç –∞–¥–º–∏–Ω–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ—Ü–µ—Å—Å—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–æ—è–≤–ª—è—é—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω–∞:** –§–æ–Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä –∑–∞–ø—É—â–µ–Ω –≤ –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –æ–∫–Ω–∞ —Å `idf_monitor`
2. –ó–∞–∫—Ä–æ–π—Ç–µ –∏—Ö –≤—Ä—É—á–Ω—É—é (Ctrl+C –∏–ª–∏ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ)
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `free_com5.bat`

---

## üìä –ß—Ç–æ –¥–µ–ª–∞—é—Ç —Å–∫—Ä–∏–ø—Ç—ã

1. **–ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:**
   - –ò—â–µ—Ç –≤—Å–µ `python.exe` –∏ `idf.py.exe`
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç COM5
   - –ù–∞—Ö–æ–¥–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã –º–æ–Ω–∏—Ç–æ—Ä–æ–≤ (`idf_monitor.py`)

2. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `taskkill /F` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ PID –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

3. **–û–∂–∏–¥–∞–Ω–∏–µ:**
   - –ü–∞—É–∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–æ—Ä—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

## üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—à–∏–≤–∫–æ–π

### –î–æ–±–∞–≤–∏—Ç—å –≤ pre-flash —Å–∫—Ä–∏–ø—Ç:
```batch
@echo off
echo Releasing COM5...
call free_com5.bat
echo.
echo Starting flash...
call idf_flash.bat
```

### –ò–ª–∏ –≤ –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É:
```cmd
free_com5.bat && idf_flash.bat
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë—ã—Å—Ç—Ä–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø—Ä–æ—à–∏–≤–∫–æ–π
```cmd
C:\esp\hydro\hydro1.0> free_com5.bat
C:\esp\hydro\hydro1.0> idf_flash.bat
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤ —Å–∫—Ä–∏–ø—Ç–µ
```powershell
# –û—Å–≤–æ–±–æ–¥–∏—Ç—å COM5 –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
powershell -ExecutionPolicy Bypass -File free_com5.ps1 -Force

# –ü–æ–¥–æ–∂–¥–∞—Ç—å
Start-Sleep -Seconds 2

# –ü—Ä–æ—à–∏—Ç—å
.\idf_flash.bat
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ–º
```powershell
# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
.\free_com5.ps1

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
# –∏ —Å–º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å, –∑–∞–≤–µ—Ä—à–∞—Ç—å –ª–∏ –∏—Ö
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   - –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã (`/F`)
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞–∂–Ω—ã–µ –ª–æ–≥–∏

2. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–æ–Ω–∏—Ç–æ—Ä—ã:**
   - –ï—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–∫–æ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∞
   - –°–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à–∏—Ç –í–°–ï –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ COM5

3. **–î—Ä—É–≥–∏–µ COM –ø–æ—Ä—Ç—ã:**
   - –î–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ—Ä—Ç–æ–≤ —Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é —Å–∫—Ä–∏–ø—Ç–∞
   - –ó–∞–º–µ–Ω–∏—Ç–µ "COM5" –Ω–∞ –Ω—É–∂–Ω—ã–π –ø–æ—Ä—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä "COM3")

---

## üõ†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –ø–æ—Ä—Ç–∞

### –î–ª—è COM3:
```powershell
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
Copy-Item free_com5.ps1 free_com3.ps1

# –ó–∞–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ COM5 –Ω–∞ COM3 (–≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ)
(Get-Content free_com3.ps1) -replace 'COM5','COM3' | Set-Content free_com3.ps1
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ESP32 –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—Ç—É
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Device Manager ‚Üí Ports (COM & LPT)
4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä (–≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ)

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞:** 2025-10-11  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** Windows 10/11, PowerShell 5.1+


