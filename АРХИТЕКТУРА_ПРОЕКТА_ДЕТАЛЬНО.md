# üèóÔ∏è –î–ï–¢–ê–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê HYDRO 1.0

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 16 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** 3.0.0-advanced  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** ESP32-S3, ESP-IDF v5.5.1

---

## üìä –¢–ï–ö–£–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### üéØ –ú–µ–Ω–µ–¥–∂–µ—Ä—ã (Managers Layer)

#### 1. **config_manager** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/config_manager/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Å–∏—Å—Ç–µ–º—ã –≤ NVS

**API:**
```c
esp_err_t config_manager_init(void);
esp_err_t config_load(system_config_t *config);
esp_err_t config_save(const system_config_t *config);
esp_err_t config_manager_get_u32(const char *key, uint32_t *value);
esp_err_t config_manager_set_u32(const char *key, uint32_t value);
```

**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç:**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∏—Å–ø–ª–µ—è (—è—Ä–∫–æ—Å—Ç—å)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã PID –¥–ª—è –≤—Å–µ—Ö 6 –Ω–∞—Å–æ—Å–æ–≤
- –¶–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è pH/EC
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

#### 2. **pump_manager** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/pump_manager/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 6 –ø–µ—Ä–∏—Å—Ç–∞–ª—å—Ç–∏—á–µ—Å–∫–∏–º–∏ –Ω–∞—Å–æ—Å–∞–º–∏ —Å PID –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º

**–£–ø—Ä–∞–≤–ª—è–µ—Ç:**
- pH UP (GPIO 1)
- pH DOWN (GPIO 2)
- EC A (GPIO 3)
- EC B (GPIO 7)
- EC C (GPIO 8)
- WATER (GPIO 16)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- PID —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (Kp, Ki, Kd –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞—Å–æ—Å–∞)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã (–æ–±—â–∏–π –æ–±—ä–µ–º, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤)
- –°—É—Ç–æ—á–Ω—ã–π —É—á–µ—Ç –¥–æ–∑–∏—Ä–æ–≤–∫–∏
- Safety limits (–º–∞–∫—Å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã, –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã)
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º

**API:**
```c
esp_err_t pump_manager_init(void);
esp_err_t pump_manager_set_pid_tunings(pump_index_t pump, float kp, float ki, float kd);
esp_err_t pump_manager_compute_and_execute(pump_index_t pump, float current, float target);
esp_err_t pump_manager_compute_and_execute_adaptive(pump_index_t pump, float current, float target);
esp_err_t pump_manager_run_direct(pump_index_t pump, uint32_t duration_ms);
esp_err_t pump_manager_get_stats(pump_index_t pump, pump_stats_t *stats);
```

---

#### 3. **screen_manager** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/lvgl_ui/screen_manager/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞–º–∏ LVGL

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
screen_manager
‚îú‚îÄ‚îÄ screen_registry.c     - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–æ–≤
‚îú‚îÄ‚îÄ screen_lifecycle.c    - –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª (create/show/hide/destroy)
‚îú‚îÄ‚îÄ screen_navigator.c    - –ù–∞–≤–∏–≥–∞—Ü–∏—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π
‚îú‚îÄ‚îÄ screen_init.c         - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–æ–≤
‚îî‚îÄ‚îÄ screen_types.h        - –¢–∏–ø—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```

**–ü–∞—Ç—Ç–µ—Ä–Ω lifecycle:**
```c
typedef struct {
    void (*on_create)(screen_base_t *base);
    void (*on_show)(screen_base_t *base);
    void (*on_hide)(screen_base_t *base);
    void (*on_destroy)(screen_base_t *base);
} screen_callbacks_t;
```

**–≠–∫—Ä–∞–Ω—ã:**
- `main_screen` - –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
- `sensor_detail_screen` - –î–µ—Ç–∞–ª–∏ –¥–∞—Ç—á–∏–∫–æ–≤
- `pumps_manual_screen` - –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏
- `pumps_status_screen` - –°—Ç–∞—Ç—É—Å –Ω–∞—Å–æ—Å–æ–≤
- `pump_calibration_screen` - –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –Ω–∞—Å–æ—Å–æ–≤
- `pid_intelligent_dashboard` - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π PID –¥–∞—à–±–æ—Ä–¥
- `pid_intelligent_detail` - –î–µ—Ç–∞–ª–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ PID
- `pid_auto_tune_screen` - –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PID
- `notification_screen` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `system_menu_screen` - –°–∏—Å—Ç–µ–º–Ω–æ–µ –º–µ–Ω—é

**API:**
```c
esp_err_t screen_manager_init(const screen_manager_config_t *config);
esp_err_t screen_show(const char *screen_id, void *params);
esp_err_t screen_hide(const char *screen_id);
esp_err_t screen_go_back(void);
esp_err_t screen_go_home(void);
```

---

#### 4. **network_manager** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/network_manager/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WiFi –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WiFi
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ AP —Ä–µ–∂–∏–º–æ–º
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- Reconnect –ª–æ–≥–∏–∫–∞

---

### üîß –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (Controllers Layer)

#### 1. **ph_ec_controller** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/ph_ec_controller/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è pH –∏ EC

**–†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑:**
- `pump_manager` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞—Å–æ—Å–æ–≤
- `system_interfaces` –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤

**–†–µ–∂–∏–º—ã:**
- –†—É—á–Ω–æ–π (manual)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (auto correction)

**API:**
```c
esp_err_t ph_ec_controller_init(void);
esp_err_t ph_ec_controller_set_auto_mode(bool ph_auto, bool ec_auto);
esp_err_t ph_ec_controller_correct_ph(float current_ph);
esp_err_t ph_ec_controller_correct_ec(float current_ec);
esp_err_t ph_ec_controller_update_values(float ph, float ec);
esp_err_t ph_ec_controller_process(void);
```

---

#### 2. **adaptive_pid** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/adaptive_pid/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∞–º–æ–æ–±—É—á–∞—é—â–∏–π—Å—è PID —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- üìö –°–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–Ω–æ–π –µ–º–∫–æ—Å—Ç–∏ —Ä–∞—Å—Ç–≤–æ—Ä–∞
- üìà –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤ (1—á, 3—á –≤–ø–µ—Ä–µ–¥)
- ‚ö° –£–ø—Ä–µ–∂–¥–∞—é—â–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è
- üéØ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã PID
- üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ NVS

**–ò—Å—Ç–æ—Ä–∏—è:**
- Ring buffer –Ω–∞ 50 –∑–Ω–∞—á–µ–Ω–∏–π
- –•—Ä–∞–Ω–∏—Ç timestamps –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤

**API:**
```c
esp_err_t adaptive_pid_init(void);
esp_err_t adaptive_pid_update(pump_index_t pump, float current_value, float target_value);
esp_err_t adaptive_pid_compute_correction(pump_index_t pump, float current, float target, float *dose_ml);
esp_err_t adaptive_pid_get_prediction(pump_index_t pump, uint32_t minutes_ahead, float *predicted_value);
esp_err_t adaptive_pid_save_all(void);
esp_err_t adaptive_pid_load_all(void);
```

---

#### 3. **pid_auto_tuner** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/pid_auto_tuner/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PID –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤

**–ú–µ—Ç–æ–¥:** Ziegler-Nichols –∏–ª–∏ Relay

---

### üîî –°–∏—Å—Ç–µ–º—ã (Systems Layer)

#### 1. **notification_system** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/notification_system/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

**–¢–∏–ø—ã:**
- CRITICAL (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏)
- ERROR (–æ—à–∏–±–∫–∏)
- WARNING (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è)
- INFO (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–¥–æ 50)
- –ü—Ä–∏–æ—Ä–∏—Ç–µ–∑–∞—Ü–∏—è
- Cooldown –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ø–∞–º–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –≤ NVS
- –û—Ç–º–µ—Ç–∫–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

**API:**
```c
esp_err_t notification_system_init(uint32_t max_notifications);
esp_err_t notification_system(notification_type_t type, const char *message, notification_source_t source);
uint32_t notification_get_unread_count(void);
```

---

#### 2. **error_handler** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/error_handler/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ö–æ–¥—ã –æ—à–∏–±–æ–∫ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- Severity levels
- Popup –æ–∫–Ω–∞ —Å –æ—à–∏–±–∫–∞–º–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**API:**
```c
esp_err_t error_handler_init(bool enable_popups);
void error_handler_report(error_code_t code, error_severity_t severity, const char *message);
void error_handler_set_font(const lv_font_t *font);
```

---

#### 3. **data_logger** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/data_logger/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–±—ã—Ç–∏–π

**–¢–∏–ø—ã –∑–∞–ø–∏—Å–µ–π:**
- –ó–Ω–∞—á–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤
- –î–µ–π—Å—Ç–≤–∏—è –Ω–∞—Å–æ—Å–æ–≤
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- –û—à–∏–±–∫–∏

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- In-memory –±—É—Ñ–µ—Ä (–¥–æ 1000 –∑–∞–ø–∏—Å–µ–π)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ NVS
- –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

**API:**
```c
esp_err_t data_logger_init(uint32_t max_entries);
esp_err_t data_logger_log_sensor_data(float ph, float ec, float temp, float humidity);
esp_err_t data_logger_log_pump_action(pump_index_t pump, bool started, const char *reason);
esp_err_t data_logger_log_system_event(log_level_t level, const char *message);
```

---

#### 4. **task_scheduler** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/task_scheduler/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–∞–¥–∞—á–∏
- Cron-like —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- Callback –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

---

#### 5. **system_interfaces** ‚úÖ
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `components/system_interfaces/`  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Adapter pattern –¥–ª—è –¥–∞—Ç—á–∏–∫–æ–≤/–∞–∫—Ç—É–∞—Ç–æ—Ä–æ–≤

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:**
```c
typedef struct {
    sensor_temp_hum_reader_t read_temperature_humidity;
    sensor_value_reader_t read_ph;
    sensor_value_reader_t read_ec;
    sensor_lux_reader_t read_lux;
    sensor_co2_reader_t read_co2;
} sensor_interface_t;

typedef struct {
    pump_run_ms_fn_t run_pump_ms;
} actuator_interface_t;
```

**–ó–∞—á–µ–º:**
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- –£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (mock –æ–±—ä–µ–∫—Ç—ã)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–º–µ–Ω—ã –¥–∞—Ç—á–∏–∫–æ–≤

---

### üîå –î—Ä–∞–π–≤–µ—Ä—ã (Drivers Layer)

#### –î–∞—Ç—á–∏–∫–∏ (Sensors):
1. **sht3x** - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å (I2C 0x44)
2. **ccs811** - CO2 –∏ VOC (I2C 0x5A)
3. **trema_ph** - pH (I2C 0x0A)
4. **trema_ec** - EC/TDS (I2C 0x08)
5. **trema_lux** - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å (I2C 0x12)

#### –ê–∫—Ç—É–∞—Ç–æ—Ä—ã (Actuators):
1. **peristaltic_pump** - 6 –Ω–∞—Å–æ—Å–æ–≤ (GPIO 1,2,3,7,8,16)
2. **trema_relay** - 4 —Ä–µ–ª–µ (GPIO 19,20,26,27)
3. **trema_expander** - –†–∞—Å—à–∏—Ä–∏—Ç–µ–ª—å GPIO

#### –î–∏—Å–ø–ª–µ–π:
1. **lcd_ili9341** - TFT 240x320 (SPI)
2. **lvgl_ui** - LVGL 9.2 —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
1. **encoder** - Rotary encoder (GPIO 4,5,6)

---

## üöÄ –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

### ‚ú® 1. sensor_manager (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∞—Ç—á–∏–∫–∏ —á–∏—Ç–∞—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ –∑–∞–¥–∞—á–∞—Ö, –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å `sensor_manager`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```c
// components/sensor_manager/sensor_manager.h

typedef struct {
    float temperature;      // ¬∞C
    float humidity;         // %
    float ph;              // pH
    float ec;              // mS/cm
    float lux;             // lux
    float co2;             // ppm
    float tvoc;            // ppb
    uint64_t timestamp;    // timestamp
    bool temp_valid;       // —Ñ–ª–∞–≥–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
    bool ph_valid;
    bool ec_valid;
    bool lux_valid;
    bool co2_valid;
} sensor_data_t;

esp_err_t sensor_manager_init(void);
esp_err_t sensor_manager_read_all(sensor_data_t *data);
esp_err_t sensor_manager_read_ph(float *ph);
esp_err_t sensor_manager_read_ec(float *ec);
esp_err_t sensor_manager_get_cached_data(sensor_data_t *data); // –ë–µ–∑ —á—Ç–µ–Ω–∏—è
esp_err_t sensor_manager_calibrate_ph(float known_value);
esp_err_t sensor_manager_calibrate_ec(float known_value);
bool sensor_manager_is_sensor_healthy(sensor_type_t sensor);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Retry –ª–æ–≥–∏–∫–∞
- ‚úÖ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ API

---

### ‚ú® 2. relay_manager (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–ª–µ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `trema_relay` –Ω–∞–ø—Ä—è–º—É—é.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å `relay_manager`

```c
// components/relay_manager/relay_manager.h

typedef enum {
    RELAY_LIGHT = 0,    // –û—Å–≤–µ—â–µ–Ω–∏–µ
    RELAY_FAN = 1,      // –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä
    RELAY_HEATER = 2,   // –ù–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å
    RELAY_RESERVE = 3   // –†–µ–∑–µ—Ä–≤
} relay_channel_t;

typedef struct {
    bool state;              // –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    uint32_t total_on_time;  // –û–±—â–µ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (—Å–µ–∫)
    uint32_t switch_count;   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
    uint64_t last_switch;    // –ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
} relay_stats_t;

esp_err_t relay_manager_init(void);
esp_err_t relay_manager_set(relay_channel_t relay, bool state);
esp_err_t relay_manager_toggle(relay_channel_t relay);
bool relay_manager_get_state(relay_channel_t relay);
esp_err_t relay_manager_schedule(relay_channel_t relay, const char *cron);
esp_err_t relay_manager_get_stats(relay_channel_t relay, relay_stats_t *stats);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å task_scheduler

---

### ‚ú® 3. calibration_manager (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:** –ï–¥–∏–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

```c
// components/calibration_manager/calibration_manager.h

typedef struct {
    float point_1_measured;
    float point_1_actual;
    float point_2_measured;
    float point_2_actual;
    float slope;
    float offset;
    uint64_t calibration_date;
    bool is_calibrated;
} calibration_data_t;

esp_err_t calibration_manager_init(void);
esp_err_t calibration_manager_start_ph(float known_value);
esp_err_t calibration_manager_start_ec(float known_value);
esp_err_t calibration_manager_add_point(sensor_type_t sensor, float measured, float actual);
esp_err_t calibration_manager_finish(sensor_type_t sensor);
esp_err_t calibration_manager_get_data(sensor_type_t sensor, calibration_data_t *data);
esp_err_t calibration_manager_apply_correction(sensor_type_t sensor, float *value);
```

---

### ‚ú® 4. recipe_manager (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—Ü–µ–ø—Ç–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π.

**–†–µ—à–µ–Ω–∏–µ:** –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ—Ü–µ–ø—Ç–æ–≤

```c
// components/recipe_manager/recipe_manager.h

typedef struct {
    char name[32];           // –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å—Ç–µ–Ω–∏—è
    float target_ph;         // –¶–µ–ª–µ–≤–æ–π pH
    float target_ec;         // –¶–µ–ª–µ–≤–æ–π EC
    float temp_min;          // –ú–∏–Ω —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
    float temp_max;          // –ú–∞–∫—Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
    uint16_t light_hours;    // –ß–∞—Å–æ–≤ —Å–≤–µ—Ç–∞ –≤ —Å—É—Ç–∫–∏
    uint16_t veg_days;       // –î–Ω–µ–π –≤–µ–≥–µ—Ç–∞—Ü–∏–∏
    uint16_t flower_days;    // –î–Ω–µ–π —Ü–≤–µ—Ç–µ–Ω–∏—è
} plant_recipe_t;

esp_err_t recipe_manager_init(void);
esp_err_t recipe_manager_add(const plant_recipe_t *recipe);
esp_err_t recipe_manager_select(const char *name);
esp_err_t recipe_manager_get_current(plant_recipe_t *recipe);
esp_err_t recipe_manager_adjust_for_stage(plant_stage_t stage);
```

---

### ‚ú® 5. alert_manager (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–µ–∂–¥—É –æ–±—ã—á–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∞–ª–µ—Ä—Ç–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ:** –ú–µ–Ω–µ–¥–∂–µ—Ä –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤

```c
// components/alert_manager/alert_manager.h

typedef enum {
    ALERT_PH_TOO_HIGH,
    ALERT_PH_TOO_LOW,
    ALERT_EC_TOO_HIGH,
    ALERT_EC_TOO_LOW,
    ALERT_TEMP_TOO_HIGH,
    ALERT_SENSOR_OFFLINE,
    ALERT_PUMP_FAILURE,
    ALERT_WATER_LOW
} alert_type_t;

esp_err_t alert_manager_init(void);
esp_err_t alert_manager_trigger(alert_type_t type, const char *details);
esp_err_t alert_manager_acknowledge(alert_type_t type);
bool alert_manager_is_active(alert_type_t type);
esp_err_t alert_manager_set_threshold(alert_type_t type, float threshold);
```

**–û—Ç–ª–∏—á–∏–µ –æ—Ç notification:**
- –ê–ª–µ—Ä—Ç—ã —Ç—Ä–µ–±—É—é—Ç —è–≤–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- –ê–ª–µ—Ä—Ç—ã –∏–º–µ—é—Ç –ø–æ—Ä–æ–≥–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
- –ê–ª–µ—Ä—Ç—ã –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∫—É
- –ê–ª–µ—Ä—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ NVS

---

### ‚ú® 6. state_machine_manager (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —è–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ —Å–∏—Å—Ç–µ–º—ã.

**–†–µ—à–µ–Ω–∏–µ:** State Machine

```c
// components/state_machine/state_machine.h

typedef enum {
    STATE_INIT,
    STATE_IDLE,
    STATE_MONITORING,
    STATE_CORRECTING,
    STATE_CALIBRATING,
    STATE_ERROR,
    STATE_MAINTENANCE
} system_state_t;

esp_err_t state_machine_init(void);
esp_err_t state_machine_transition(system_state_t new_state);
system_state_t state_machine_get_current(void);
bool state_machine_can_transition(system_state_t from, system_state_t to);
```

---

## üìã –ü–†–ò–û–†–ò–¢–ï–¢–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å):
1. ‚úÖ **sensor_manager** - –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
2. ‚úÖ **relay_manager** - –£–ª—É—á—à–∏—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ):
3. ‚ö†Ô∏è **calibration_manager** - –£–ø—Ä–æ—Å—Ç–∏—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫—É
4. ‚ö†Ô∏è **alert_manager** - –ü–æ–≤—ã—Å–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ö–æ—Ä–æ—à–æ –∏–º–µ—Ç—å):
5. üí° **recipe_manager** - –£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
6. üí° **state_machine_manager** - –ë–æ–ª–µ–µ —è–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

---

## üîÑ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –†–ï–§–ê–ö–¢–û–†–ò–ù–ì

### –®–∞–≥ 1: –í–Ω–µ–¥—Ä–∏—Ç—å sensor_manager

**–ë—ã–ª–æ:**
```c
// –í sensor_task –Ω–∞–ø—Ä—è–º—É—é
float temp, humidity;
sht3x_read(&temp, &humidity);

float ph;
trema_ph_read(&ph);
```

**–°—Ç–∞–ª–æ:**
```c
// –ß–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä
sensor_data_t data;
sensor_manager_read_all(&data);

if (data.ph_valid) {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ
}
```

---

### –®–∞–≥ 2: –í–Ω–µ–¥—Ä–∏—Ç—å relay_manager

**–ë—ã–ª–æ:**
```c
// –ü—Ä—è–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
trema_relay_set(0, true);  // –í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç
```

**–°—Ç–∞–ª–æ:**
```c
// –ß–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä
relay_manager_set(RELAY_LIGHT, true);

// –ò–ª–∏ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
relay_manager_schedule(RELAY_LIGHT, "0 8 * * *"); // –í–∫–ª—é—á–∞—Ç—å –≤ 8:00
```

---

## üìê –î–ò–ê–ì–†–ê–ú–ú–ê –£–õ–£–ß–®–ï–ù–ù–û–ô –ê–†–•–ò–¢–ï–ö–¢–£–†–´

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        app_main.c                            ‚îÇ
‚îÇ                    (Orchestrator)                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ     –ú–ï–ù–ï–î–ñ–ï–†–´ (Managers Layer)        ‚îÇ
        ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê   ‚îÇ
        ‚îÇ  ‚Ä¢ sensor_manager    ‚Üê [–ù–û–í–´–ô]         ‚îÇ
        ‚îÇ  ‚Ä¢ relay_manager     ‚Üê [–ù–û–í–´–ô]         ‚îÇ
        ‚îÇ  ‚Ä¢ pump_manager                        ‚îÇ
        ‚îÇ  ‚Ä¢ screen_manager                      ‚îÇ
        ‚îÇ  ‚Ä¢ config_manager                      ‚îÇ
        ‚îÇ  ‚Ä¢ network_manager                     ‚îÇ
        ‚îÇ  ‚Ä¢ calibration_mgr   ‚Üê [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û]   ‚îÇ
        ‚îÇ  ‚Ä¢ recipe_manager    ‚Üê [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û]   ‚îÇ
        ‚îÇ  ‚Ä¢ alert_manager     ‚Üê [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û]   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ                       ‚îÇ
             ‚Üì                       ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ   –ö–û–ù–¢–†–û–õ–õ–ï–†–´    ‚îÇ    ‚îÇ     –°–ò–°–¢–ï–ú–´          ‚îÇ
  ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  ‚îÇ    ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  ‚îÇ
  ‚îÇ  ‚Ä¢ ph_ec_ctrl    ‚îÇ    ‚îÇ  ‚Ä¢ notification_sys  ‚îÇ
  ‚îÇ  ‚Ä¢ adaptive_pid  ‚îÇ    ‚îÇ  ‚Ä¢ error_handler     ‚îÇ
  ‚îÇ  ‚Ä¢ pid_tuner     ‚îÇ    ‚îÇ  ‚Ä¢ data_logger       ‚îÇ
  ‚îÇ                  ‚îÇ    ‚îÇ  ‚Ä¢ task_scheduler    ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ  ‚Ä¢ system_ifaces     ‚îÇ
           ‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ   –î–†–ê–ô–í–ï–†–´       ‚îÇ
  ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  ‚îÇ
  ‚îÇ  ‚Ä¢ sht3x         ‚îÇ
  ‚îÇ  ‚Ä¢ ccs811        ‚îÇ
  ‚îÇ  ‚Ä¢ trema_ph      ‚îÇ
  ‚îÇ  ‚Ä¢ trema_ec      ‚îÇ
  ‚îÇ  ‚Ä¢ trema_lux     ‚îÇ
  ‚îÇ  ‚Ä¢ trema_relay   ‚îÇ
  ‚îÇ  ‚Ä¢ pump_driver   ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚úÖ –¢–ï–ö–£–©–ò–ï –°–ò–õ–¨–ù–´–ï –°–¢–û–†–û–ù–´

1. ‚úÖ **–û—Ç–ª–∏—á–Ω–∞—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
2. ‚úÖ **–ú–µ–Ω–µ–¥–∂–µ—Ä—ã —É–∂–µ –µ—Å—Ç—å** - config, pump, screen, network
3. ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π PID** - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
4. ‚úÖ **Screen lifecycle** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è UI
5. ‚úÖ **System interfaces** - adapter pattern
6. ‚úÖ **–ú–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç—å** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FreeRTOS
7. ‚úÖ **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –º—å—é—Ç–µ–∫—Å—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏–π
8. ‚úÖ **NVS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
9. ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —á–µ—Ä–µ–∑ error_handler
10. ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - data_logger –¥–ª—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π

---

## üéØ –ò–¢–û–ì–û–í–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å:

1. **–î–æ–±–∞–≤–∏—Ç—å sensor_manager** (1-2 –¥–Ω—è)
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑—É–µ—Ç —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤
   - –£–ª—É—á—à–∏—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
   - –£–ø—Ä–æ—Å—Ç–∏—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞—Ç—á–∏–∫–æ–≤

2. **–î–æ–±–∞–≤–∏—Ç—å relay_manager** (1 –¥–µ–Ω—å)
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–ª–µ
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å scheduler
   - –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π

3. **–û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é** (—Å–µ–π—á–∞—Å)
   - –î–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
   - –£–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –Ω–æ–≤—ã—Ö AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤

### –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ—Ç–æ–º (–ø–æ –∂–µ–ª–∞–Ω–∏—é):

4. **calibration_manager** - –∫–æ–≥–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è UI –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
5. **alert_manager** - –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤
6. **recipe_manager** - –∫–æ–≥–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä

---

**–ü—Ä–æ–µ–∫—Ç —É–∂–µ –∏–º–µ–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É! –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è - —ç—Ç–æ "nice to have", –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã.**


