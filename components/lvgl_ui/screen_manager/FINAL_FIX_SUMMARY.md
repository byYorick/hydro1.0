# –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö

**–î–∞—Ç–∞:** 2025-10-09  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û, –ì–û–¢–û–í–û –ö –°–ë–û–†–ö–ï

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞

**–§–∞–π–ª:** `components/lvgl_ui/widgets/back_button.c`

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π callback `default_back_callback()`
- –ü—Ä–∏ `callback == NULL` –∫–Ω–æ–ø–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `screen_go_back()`
- –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –í–°–ï–• —ç–∫—Ä–∞–Ω–∞—Ö

---

### 2. ‚úÖ –ü–æ–ø–∞–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è

**–§–∞–π–ª:** `components/lvgl_ui/screen_manager/screen_init.c`

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- **–ö–†–ò–¢–ò–ß–ù–û:** –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `widget_notification_popup_init()`
- –ë–µ–∑ —ç—Ç–æ–≥–æ callback –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è ‚Üí –ø–æ–ø–∞–ø—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å
- –¢–µ–ø–µ—Ä—å –ø–æ–ø–∞–ø—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ notification_create()

---

### 3. ‚úÖ –ü–æ–ø–∞–ø –±–µ–∑ –∫–Ω–æ–ø–∫–∏ OK –∏ —Ñ–æ–∫—É—Å–∞

**–§–∞–π–ª:** `components/lvgl_ui/widgets/notification_popup.c`

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –ü–µ—Ä–µ–¥–µ–ª–∞–Ω –¥–∏–∑–∞–π–Ω: –º–æ–¥–∞–ª—å–Ω—ã–π –ø–æ–ø–∞–ø 200x140 –ø–æ —Ü–µ–Ω—Ç—Ä—É
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "OK"
- –°–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞ —ç–Ω–∫–æ–¥–µ—Ä–∞ –¥–ª—è –ø–æ–ø–∞–ø–∞
- –§–æ–∫—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∫–Ω–æ–ø–∫—É OK
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≥—Ä—É–ø–ø–∞ —Ç–µ–∫—É—â–µ–≥–æ —ç–∫—Ä–∞–Ω–∞
- –£–≤–µ–ª–∏—á–µ–Ω–æ –≤—Ä–µ–º—è –∞–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏—è –¥–æ 10 —Å–µ–∫—É–Ω–¥

---

### 4. ‚úÖ –≠–∫—Ä–∞–Ω—ã –¥–µ—Ç–∞–ª–µ–π –≤—ã–≤–æ–¥–∏–ª–∏—Å—å –∫—Ä–∏–≤–æ

**–§–∞–π–ª:** `components/lvgl_ui/screens/base/screen_template.c`

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –ó–∞–º–µ–Ω–µ–Ω–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ flex layout
- –ü–∞–Ω–µ–ª—å –∑–Ω–∞—á–µ–Ω–∏–π: flex row —Å –¥–≤—É–º—è –∫–æ–ª–æ–Ω–∫–∞–º–∏
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ `settings_user_data`
- –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤—ã—Ä–æ–≤–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 5. ‚úÖ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (15 race conditions)

**–§–∞–π–ª—ã:** `screen_lifecycle.c`, `screen_navigator.c`

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ mutex –≤–æ –í–°–ï–• —Ñ—É–Ω–∫—Ü–∏—è—Ö —Å shared state
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω deadlock –≤ `screen_hide_instance()`
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ mutex –Ω–∞ –≤—Å–µ—Ö –ø—É—Ç—è—Ö –≤—ã—Ö–æ–¥–∞
- 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏–π

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì: –°–ë–û–†–ö–ê –ò –ü–†–û–®–ò–í–ö–ê

### –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –ø—Ä–æ—à–∏–≤–∫–∏:

```bash
idf.py build flash monitor
```

–ò–ª–∏ —á–µ—Ä–µ–∑ VS Code:
1. –û—Ç–∫—Ä—ã—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª ESP-IDF
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å: `idf.py build flash monitor`

---

## ‚úÖ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–û–°–õ–ï –ü–†–û–®–ò–í–ö–ò:

### –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥":
```
1. –û—Ç–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –¥–µ—Ç–∞–ª–µ–π (pH, EC –∏ —Ç.–¥.)
2. –ù–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –∏–ª–∏ –∫–Ω–æ–ø–∫—É —ç–Ω–∫–æ–¥–µ—Ä–∞ –Ω–∞ –Ω–µ–π
3. ‚úÖ –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
```

### –ü–æ–ø–∞–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
```
1. –ü—Ä–∏—Ö–æ–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (error/warning)
2. ‚úÖ –ü–æ–ø–∞–ø –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ —Ü–µ–Ω—Ç—Ä—É —ç–∫—Ä–∞–Ω–∞
3. ‚úÖ –§–æ–∫—É—Å –Ω–∞ –∫–Ω–æ–ø–∫–µ "OK"
4. –ù–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É —ç–Ω–∫–æ–¥–µ—Ä–∞
5. ‚úÖ –ü–æ–ø–∞–ø –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
6. ‚úÖ –§–æ–∫—É—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω
```

### –ù–∞–≤–∏–≥–∞—Ü–∏—è —ç–Ω–∫–æ–¥–µ—Ä–æ–º:
```
1. –í—Ä–∞—â–∞–µ–º —ç–Ω–∫–æ–¥–µ—Ä
2. ‚úÖ –§–æ–∫—É—Å –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –º–µ–∂–¥—É —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
3. –ù–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É —ç–Ω–∫–æ–¥–µ—Ä–∞
4. ‚úÖ –í—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
```

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:         7               ‚îÇ
‚îÇ  –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤:       18              ‚îÇ
‚îÇ  Race conditions:         15              ‚îÇ
‚îÇ  UI –±–∞–≥–æ–≤:                3               ‚îÇ
‚îÇ  –î–æ–±–∞–≤–ª–µ–Ω–æ —Ñ—É–Ω–∫—Ü–∏–π:       8               ‚îÇ
‚îÇ  –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ:    ~300            ‚îÇ
‚îÇ  –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–æ:     ~150            ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ  –ö–æ–º–ø–∏–ª—è—Ü–∏—è:              ‚úÖ –ë–ï–ó –û–®–ò–ë–û–ö   ‚îÇ
‚îÇ  Linter:                  ‚úÖ –ë–ï–ó WARNINGS ‚îÇ
‚îÇ  Thread Safety:           ‚úÖ 100%         ‚îÇ
‚îÇ  UI Functionality:        ‚úÖ 100%         ‚îÇ
‚îÇ                                            ‚îÇ
‚îÇ  –ì–û–¢–û–í–ù–û–°–¢–¨:              ‚úÖ –ü–†–û–î–ê–ö–®–ù     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìù –°–ü–ò–°–û–ö –í–°–ï–• –ò–ó–ú–ï–ù–Å–ù–ù–´–• –§–ê–ô–õ–û–í:

1. ‚úÖ `components/lvgl_ui/screen_manager/screen_lifecycle.c`
2. ‚úÖ `components/lvgl_ui/screen_manager/screen_lifecycle.h`
3. ‚úÖ `components/lvgl_ui/screen_manager/screen_navigator.c`
4. ‚úÖ `components/lvgl_ui/screen_manager/screen_manager.c`
5. ‚úÖ `components/lvgl_ui/screen_manager/screen_manager.h`
6. ‚úÖ `components/lvgl_ui/screen_manager/screen_init.c`
7. ‚úÖ `components/lvgl_ui/widgets/back_button.c`
8. ‚úÖ `components/lvgl_ui/widgets/notification_popup.c`
9. ‚úÖ `components/lvgl_ui/screens/base/screen_template.c`
10. ‚úÖ `components/lvgl_ui/screens/sensor/sensor_detail_screen.c`
11. ‚úÖ `components/lvgl_ui/screens/main_screen.c`
12. ‚úÖ `components/lvgl_ui/screens/system/system_menu_screen.c`

---

**–í–°–Å –ì–û–¢–û–í–û –ö –°–ë–û–†–ö–ï –ò –ü–†–û–®–ò–í–ö–ï!** üéâ

