# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º –ø—Ä–æ–µ–∫—Ç–∞ Hydro 1.0

## –î–∞—Ç–∞: 7 –æ–∫—Ç—è–±—Ä—è 2025

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ESP-IDF –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª—ë–Ω –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–∫—Ä—É–∂–µ–Ω–∏—è: `esp-idf-29323a3f5a0574597d6dbaa0af20c775`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã:
  - `.vscode/settings.json` - —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –ø—É—Ç—å –∫ –æ–∫—Ä—É–∂–µ–Ω–∏—é
  - `.vscode/tasks.json` - –≤—Å–µ –∑–∞–¥–∞—á–∏ (Build, Flash, Monitor)

### 2. ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ–∫—É—Å–∞ —ç–Ω–∫–æ–¥–µ—Ä–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –§–æ–∫—É—Å –º–µ–Ω—è–ª —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –ø–∞–Ω–µ–ª–µ–π  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–º–∫–∏ –≤–º–µ—Å—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–æ–Ω–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å—Ç–∏–ª—å —Ñ–æ–∫—É—Å–∞ —Å —Ä–∞–º–∫–æ–π:
  ```c
  lv_style_set_border_color(&style_focus, COLOR_ACCENT);   // –ë–∏—Ä—é–∑–æ–≤–∞—è —Ä–∞–º–∫–∞ 3px
  lv_style_set_outline_color(&style_focus, COLOR_ACCENT);  // –û–±–≤–æ–¥–∫–∞ 2px
  ```
- –î–æ–±–∞–≤–ª–µ–Ω —Ç–∞–π–º–µ—Ä –∞–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏—è —Ñ–æ–∫—É—Å–∞ (30 —Å–µ–∫—É–Ω–¥)
- –§—É–Ω–∫—Ü–∏–∏: `show_focus()`, `hide_focus()`, `reset_focus_timer()`
- –§–æ–∫—É—Å —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ª—é–±–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —ç–Ω–∫–æ–¥–µ—Ä–∞

### 3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞ —Å–µ–Ω—Å–æ—Ä–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–ª–∞—Å—å —á–µ—Ä–µ–∑ 3 –º–∏–Ω—É—Ç—ã –∏–∑-–∑–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –£–º–µ–Ω—å—à–µ–Ω —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏: 5 ‚Üí 3 —ç–ª–µ–º–µ–Ω—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ `system_tasks.c`:
  ```c
  if (xQueueSend(...) != pdTRUE) {
      sensor_data_t oldest;
      xQueueReceive(..., &oldest, 0);  // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ
      xQueueSend(..., &sensor_data, 0); // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ
  }
  ```
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ `display_update_task`:
  - –ë–µ—Ä—ë—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ—á–µ—Ä–µ–¥–∏ –∑–∞ —Ä–∞–∑
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  - –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 10–º—Å ‚Üí 200–º—Å

### 4. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ Data Logger
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤—ã–∑—ã–≤–∞–ª–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç–µ–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–µ–Ω —Å—Ç–µ–∫: 2048 –±–∞–π—Ç (8KB) ‚Üí 4096 –±–∞–π—Ç (16KB)
- –í–∫–ª—é—á–µ–Ω–∞ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ä—à–µ 3 –¥–Ω–µ–π:
  ```c
  data_logger_set_auto_cleanup(true, 3);
  ```

### 5. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ I2C –∞–¥—Ä–µ—Å–æ–≤ Trema —Å–µ–Ω—Å–æ—Ä–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ I2C –∞–¥—Ä–µ—Å–∞

**–ë—ã–ª–æ:**
- pH: `0x48` ‚ùå
- EC: `0x49` ‚ùå

**–°—Ç–∞–ª–æ (—Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏):**
- pH: `0x0A` ‚úÖ (Model ID: 0x1A)
- EC: `0x08` ‚úÖ (Model ID: 0x19)

### 6. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è EC
**–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏!** EC –∏–∑–º–µ—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (~2% –Ω–∞ –≥—Ä–∞–¥—É—Å)

```c
// –í system_tasks.c –ø–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º EC:
if (data->valid[SENSOR_INDEX_TEMPERATURE]) {
    trema_ec_set_temperature(data->temperature);
}
```

### 7. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ EC —Å–µ–Ω—Å–æ—Ä–∞
- –î–æ–±–∞–≤–ª–µ–Ω `#include "trema_ec.h"` –≤ `system_tasks.c`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —á—Ç–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–∞: 0-10 mS/cm

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –†–∞–∑–º–µ—Ä—ã —Å—Ç–µ–∫–∞ –∑–∞–¥–∞—á:
- `TASK_STACK_SIZE_SENSOR`: 5120 –±–∞–π—Ç (20KB)
- `TASK_STACK_SIZE_DISPLAY`: 3072 –±–∞–π—Ç (12KB)
- `TASK_STACK_SIZE_DATALOGGER`: **4096 –±–∞–π—Ç (16KB)** ‚¨ÜÔ∏è —É–≤–µ–ª–∏—á–µ–Ω
- `TASK_STACK_SIZE_NOTIFICATION`: 2560 –±–∞–π—Ç (10KB)
- `TASK_STACK_SIZE_SCHEDULER`: 2048 –±–∞–π—Ç (8KB)
- `TASK_STACK_SIZE_PH_EC`: 2048 –±–∞–π—Ç (8KB)

### –†–∞–∑–º–µ—Ä—ã –æ—á–µ—Ä–µ–¥–µ–π:
- `QUEUE_SIZE_SENSOR_DATA`: **3** ‚¨áÔ∏è —É–º–µ–Ω—å—à–µ–Ω
- `QUEUE_SIZE_ENCODER`: 10
- `QUEUE_SIZE_NOTIFICATIONS`: 10

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ–∫—É—Å–∞:
- –¢–∞–π–º–∞—É—Ç –∞–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏—è: 30 —Å–µ–∫—É–Ω–¥
- –¢–æ–ª—â–∏–Ω–∞ —Ä–∞–º–∫–∏: 3px
- –¢–æ–ª—â–∏–Ω–∞ –æ–±–≤–æ–¥–∫–∏: 2px
- –¶–≤–µ—Ç: –±–∏—Ä—é–∑–æ–≤—ã–π (COLOR_ACCENT)

## –ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ Trema —Å–µ–Ω—Å–æ—Ä–æ–≤

### pH —Å–µ–Ω—Å–æ—Ä (–∞–¥—Ä–µ—Å 0x0A)
| –†–µ–≥–∏—Å—Ç—Ä | –ê–¥—Ä–µ—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|----------|
| MODEL | 0x04 | ID –º–æ–¥–µ–ª–∏ (0x1A) |
| KNOWN_PH | 0x0A | –ò–∑–≤–µ—Å—Ç–Ω—ã–π pH –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (2 –±–∞–π—Ç–∞) |
| CALIBRATION | 0x10 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π |
| pH | 0x1D | –ó–Ω–∞—á–µ–Ω–∏–µ pH (2 –±–∞–π—Ç–∞) |
| ERROR | 0x1F | –§–ª–∞–≥–∏ –æ—à–∏–±–æ–∫ |

### EC —Å–µ–Ω—Å–æ—Ä (–∞–¥—Ä–µ—Å 0x08)
| –†–µ–≥–∏—Å—Ç—Ä | –ê–¥—Ä–µ—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-------|----------|
| MODEL | 0x04 | ID –º–æ–¥–µ–ª–∏ (0x19) |
| KNOWN_TDS | 0x0A | –ò–∑–≤–µ—Å—Ç–Ω—ã–π TDS –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (2 –±–∞–π—Ç–∞) |
| CALIBRATION | 0x10 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π |
| TDS_t | 0x19 | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ |
| TDS_S | 0x20 | –ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å (2 –±–∞–π—Ç–∞) |
| TDS_EC | 0x22 | –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–æ–¥–∏–º–æ—Å—Ç—å (2 –±–∞–π—Ç–∞) |
| TDS_TDS | 0x24 | –ó–Ω–∞—á–µ–Ω–∏–µ TDS (2 –±–∞–π—Ç–∞) |

## –†–∞–∑–º–µ—Ä –ø—Ä–æ—à–∏–≤–∫–∏
**696 KB** –∏–∑ 1 MB (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ 67%, —Å–≤–æ–±–æ–¥–Ω–æ 33%)

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `.vscode/settings.json`
- `.vscode/tasks.json`
- `main/system_config.h`

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `components/lvgl_main/lvgl_main.c` - —Ñ–æ–∫—É—Å, –±—É—Ñ–µ—Ä, UI
- `components/trema_ec/trema_ec.c` - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –∞–¥—Ä–µ—Å
- `components/system_tasks/system_tasks.c` - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è, –±—É—Ñ–µ—Ä
- `main/app_main.c` - –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ logger

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å | –†–µ—à–µ–Ω–∏–µ |
|----------|--------|---------|
| –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ —Å–µ–Ω—Å–æ—Ä–æ–≤ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—á–µ—Ä–µ–¥–∏ |
| –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 3 –º–∏–Ω | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è |
| Stack overflow data_logger | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –£–≤–µ–ª–∏—á–µ–Ω —Å—Ç–µ–∫ –¥–æ 16KB |
| –§–æ–∫—É—Å –º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–º–∫–∏ |
| –§–æ–∫—É—Å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ 30 —Å–µ–∫ |
| EC –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å + temp –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è |
| pH –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | 0x48 ‚Üí 0x0A |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

1. **I2C –∞–¥—Ä–µ—Å–∞ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ datasheet**
2. **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è EC**
3. **–†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏**
4. **–°—Ç–µ–∫ –∑–∞–¥–∞—á —Å NVS –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏: –º–∏–Ω–∏–º—É–º 16KB**
5. **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è –¥–æ–ª–≥–æ–π —Ä–∞–±–æ—Ç—ã**
6. **UI —Ñ–æ–∫—É—Å - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–º–∫—É, –Ω–µ –º–µ–Ω—è—Ç—å —Ñ–æ–Ω**
7. **–¢–∞–π–º–∞—É—Ç—ã —Å–∫—Ä—ã—Ç–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ª—É—á—à–∞—é—Ç UX**

## –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ

