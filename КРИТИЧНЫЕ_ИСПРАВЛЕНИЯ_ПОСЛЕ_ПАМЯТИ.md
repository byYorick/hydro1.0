# ๐ง ะัะธัะธัะฝัะต ะธัะฟัะฐะฒะปะตะฝะธั ะฟะพัะปะต ะฟะตัะตัะฐัะฟัะตะดะตะปะตะฝะธั ะฟะฐะผััะธ

**ะะฐัะฐ:** 2025-10-16  
**ะกัะฐััั:** โ **ะะกะ ะะะะะะะะซ ะะะจะะะซ**

---

## ๐ด ะะฑะฝะฐััะถะตะฝะฝัะต ะฟัะพะฑะปะตะผั

ะะพัะปะต ะฟะตัะตัะฐัะฟัะตะดะตะปะตะฝะธั ะฟะฐะผััะธ ะธ ะฒะบะปััะตะฝะธั WiFi ะฒ ะปะพะณะฐั ะฟะพัะฒะธะปะธัั ะบัะธัะธัะฝัะต ะพัะธะฑะบะธ:

### 1. Watchdog Timeout ะฝะฐ LVGL Task
```
E (18727) task_wdt: Task watchdog got triggered
E (18727) task_wdt:  - IDLE1 (CPU 1)
E (18727) task_wdt: CPU 1: LVGL
Backtrace: wait_for_flushing โ lv_timer_handler โ lvgl_task_handler
```

**ะัะพะฑะปะตะผะฐ:** LVGL task ะทะฐะฒะธัะฐะตั ะฒ `wait_for_flushing()` ะพะถะธะดะฐั ะทะฐะฒะตััะตะฝะธั SPI ะฟะตัะตะดะฐัะธ.

---

### 2. SPI ะัะตัะตะดั ะะตัะตะฟะพะปะฝะตะฝะฐ
```
W (18703) lcd_panel.io.spi: spi transmit (queue) color failed
```

**ะัะพะฑะปะตะผะฐ:** SPI ะพัะตัะตะดั (`trans_queue_depth = 10`) ะฟะตัะตะฟะพะปะฝัะตััั ะฟัะธ ะธะฝัะตะฝัะธะฒะฝะพะน ะพััะธัะพะฒะบะต.

---

### 3. LVGL Mutex Contention
```
W (18059) LVGL_MAIN: Failed to get LVGL lock in display task (timeout 500ms)
W (18368) LVGL_MAIN: Failed to get LVGL lock in display task (timeout 500ms)
```

**ะัะพะฑะปะตะผะฐ:** Display task ะฝะต ะผะพะถะตั ะฟะพะปััะธัั LVGL ะผัััะตะบั ะฒ ัะตัะตะฝะธะต 500 ะผั ะธะท-ะทะฐ ะดะพะปะณะพะน SPI ะฟะตัะตะดะฐัะธ ะฒ LVGL timer task.

---

### 4. Notification Queue Overflow
```
W (18059) NOTIF_SCREEN: >>> FAILED to queue notification - queue FULL!
W (18174) NOTIF_SCREEN: >>> FAILED to queue error - queue FULL!
```

**ะัะพะฑะปะตะผะฐ:** ะัะตัะตะดั ัะฒะตะดะพะผะปะตะฝะธะน (`NOTIF_QUEUE_SIZE = 5`) ะฟะตัะตะฟะพะปะฝัะตััั ะธะท-ะทะฐ ะผะฝะพะถะตััะฒะตะฝะฝัั I2C ะพัะธะฑะพะบ.

---

### 5. I2C ะะฐััะธะบะธ ะะต ะัะฒะตัะฐัั (ะะฝะพะถะตััะฒะตะฝะฝัะน ะกะฟะฐะผ)
```
E (18227) i2c.master: I2C transaction unexpected nack detected
W (18239) trema_ph: Failed to write to pH sensor
E (18306) i2c_bus: [I2C] ะัะธะฑะบะฐ ะทะฐะฟะธัะธ ะฝะฐ ััััะพะนััะฒะพ 0x0A
E (18227) i2c.master: I2C transaction unexpected nack detected
W (18550) i2c_bus: Failed to write to device 0x0A: ESP_ERR_INVALID_STATE
```

**ะัะพะฑะปะตะผะฐ:** ะะฐััะธะบะธ 0x44 (SHT3X) ะธ 0x0A (TREMA_PH) ัะธะทะธัะตัะบะธ ะฝะต ะฟะพะดะบะปััะตะฝั, ะณะตะฝะตัะธัััั ัะพัะฝะธ ะพัะธะฑะพะบ ะฒ ัะตะบัะฝะดั, ะฟะตัะตะฟะพะปะฝััั ะพัะตัะตะดั ัะฒะตะดะพะผะปะตะฝะธะน.

---

## โ ะะตัะตะฝะธั

### 1. ะัะฟัะฐะฒะปะตะฝะธะต Watchdog Timeout

**ะคะฐะนะป:** `components/lcd_ili9341/lcd_ili9341.c`

**ะะทะผะตะฝะตะฝะธั:**
```c
// ะะพะฑะฐะฒะปะตะฝ include
#include "esp_task_wdt.h"

// ะะพะฑะฐะฒะปะตะฝั ัะฑัะพัั watchdog ะฒ lvgl_task_handler()
static void lvgl_task_handler(void *pvParameters)
{
    while (1) {
        // ะกะฑัะพั watchdog ะะ ะทะฐัะฒะฐัะฐ ะผัััะตะบัะฐ
        esp_task_wdt_reset();
        
        if (lvgl_lock(-1)) {
            if (lv_is_initialized()) {
                task_delay_ms = lv_timer_handler();
                
                // ะกะฑัะพั watchdog ะะะกะะ ะพะฑัะฐะฑะพัะบะธ (ะผะพะถะตั ะทะฐะฝััั ะฒัะตะผั ะฟัะธ ะพััะธัะพะฒะบะต)
                esp_task_wdt_reset();
            }
            lvgl_unlock();
        }
        
        vTaskDelay(pdMS_TO_TICKS(task_delay_ms));
    }
}
```

**ะะตะทัะปััะฐั:** Watchdog ัะฑัะฐััะฒะฐะตััั ะดะพ ะธ ะฟะพัะปะต ะดะปะธัะตะปัะฝะพะน ะพััะธัะพะฒะบะธ โ

---

### 2. ะฃะฒะตะปะธัะตะฝะธะต SPI ะัะตัะตะดะธ

**ะคะฐะนะป:** `components/lcd_ili9341/lcd_ili9341.c`

**ะะทะผะตะฝะตะฝะธั:**
```c
// ะะ:
.trans_queue_depth = 10,  // โ๏ธ ะะตัะตะฟะพะปะฝัะตััั!

// ะะะกะะ:
.trans_queue_depth = 30,  // โ ะ 3 ัะฐะทะฐ ะฑะพะปััะต
```

**ะะตะทัะปััะฐั:** SPI ะพัะตัะตะดั ัะตะฟะตัั ะฒะผะตัะฐะตั ะดะพ 30 ััะฐะฝะทะฐะบัะธะน ะพะดะฝะพะฒัะตะผะตะฝะฝะพ โ

---

### 3. ะะฟัะธะผะธะทะฐัะธั LVGL ะััะตัะพะฒ

**ะคะฐะนะป:** `components/lcd_ili9341/lcd_ili9341.c`

**ะะทะผะตะฝะตะฝะธั:**
```c
// ะะ:
disp_buf1 = heap_caps_malloc(LCD_H_RES * 60 * sizeof(lv_color_t), ...);  // 28.8 KB
disp_buf2 = heap_caps_malloc(LCD_H_RES * 60 * sizeof(lv_color_t), ...);  // 28.8 KB

// ะะะกะะ:
disp_buf1 = heap_caps_malloc(LCD_H_RES * 40 * sizeof(lv_color_t), ...);  // 19.2 KB
disp_buf2 = heap_caps_malloc(LCD_H_RES * 40 * sizeof(lv_color_t), ...);  // 19.2 KB
```

**ะัะณะพะดะฐ:**
- ะะตะฝััะต ะดะฐะฝะฝัั โ ะฑััััะตะต ะพััะธัะพะฒะบะฐ โ ะผะตะฝััะต ะฒัะตะผะตะฝะธ ะดะตัะถะธะผ ะผัััะตะบั
- ะัะฒะพะฑะพะถะดะตะฝะพ 19.2 KB PSRAM
- ะะตะฝััะต ะฝะฐะณััะทะบะฐ ะฝะฐ SPI ะพัะตัะตะดั

---

### 4. ะฃะฒะตะปะธัะตะฝะธะต SPI Max Transfer

**ะคะฐะนะป:** `components/lcd_ili9341/lcd_ili9341.c`

**ะะทะผะตะฝะตะฝะธั:**
```c
// ะะ:
.max_transfer_sz = LCD_H_RES * 80 * sizeof(uint16_t),  // 38.4 KB

// ะะะกะะ:
.max_transfer_sz = LCD_H_RES * 100 * sizeof(uint16_t),  // 48 KB
```

**ะะตะทัะปััะฐั:** SPI ะผะพะถะตั ะฟะตัะตะดะฐะฒะฐัั ะฑะพะปััะต ะดะฐะฝะฝัั ะทะฐ ัะฐะท โ

---

### 5. ะฃะฒะตะปะธัะตะฝะธะต Notification Queue

**ะคะฐะนะป:** `components/lvgl_ui/screens/notification_screen.c`

**ะะทะผะตะฝะตะฝะธั:**
```c
// ะะ:
#define NOTIF_QUEUE_SIZE 5  // โ๏ธ ะะตัะตะฟะพะปะฝัะตััั!

// ะะะกะะ:
#define NOTIF_QUEUE_SIZE 20  // โ ะ 4 ัะฐะทะฐ ะฑะพะปััะต
```

**ะะตะทัะปััะฐั:** ะัะตัะตะดั ะฒะผะตัะฐะตั ะดะพ 20 ัะฒะตะดะพะผะปะตะฝะธะน ะพะดะฝะพะฒัะตะผะตะฝะฝะพ โ

---

### 6. ะะฐัะธัะฐ ะพั ะกะฟะฐะผะฐ I2C ะัะธะฑะพะบ

**ะคะฐะนะป:** `components/sensor_manager/sensor_manager.c`

**ะะพะฑะฐะฒะปะตะฝะพ:**
```c
// ะกัะตััะธะบะธ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝัั ะพัะธะฑะพะบ
#define MAX_CONSECUTIVE_ERRORS 10
#define ERROR_RETRY_INTERVAL_MS 60000
static uint8_t consecutive_errors[SENSOR_TYPE_COUNT] = {0};
static uint64_t sensor_disabled_until[SENSOR_TYPE_COUNT] = {0};

// ะคัะฝะบัะธั ะฟัะพะฒะตัะบะธ ะดะพัััะฟะฝะพััะธ ะดะฐััะธะบะฐ
static bool is_sensor_enabled(sensor_type_t sensor)
{
    uint64_t now = esp_timer_get_time() / 1000;
    return now >= sensor_disabled_until[sensor];
}

// ะ update_stats() ะดะพะฑะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ:
if (consecutive_errors[sensor] >= MAX_CONSECUTIVE_ERRORS) {
    sensor_disabled_until[sensor] = now + ERROR_RETRY_INTERVAL_MS;
    ESP_LOGW(TAG, "Sensor %d disabled until %llu ms (too many errors)", sensor, ...);
    consecutive_errors[sensor] = 0;
}

// ะะพ ะฒัะต read_*_with_retry() ะดะพะฑะฐะฒะปะตะฝะฐ ะฟัะพะฒะตัะบะฐ:
if (!is_sensor_enabled(SENSOR_TYPE_XXX)) {
    return false;  // ะัะพะฟััะบะฐะตะผ ััะตะฝะธะต
}
```

**ะะตะทัะปััะฐั:**
- โ ะะพัะปะต 10 ะพัะธะฑะพะบ ะฟะพะดััะด ะดะฐััะธะบ ะพัะบะปััะฐะตััั ะฝะฐ 60 ัะตะบัะฝะด
- โ ะะตั ัะฟะฐะผะฐ ัะฒะตะดะพะผะปะตะฝะธะน (ะฑัะปะพ: ัะพัะฝะธ ะพัะธะฑะพะบ/ัะตะบ โ ััะฐะปะพ: 1 ะฟัะตะดัะฟัะตะถะดะตะฝะธะต/60 ัะตะบ)
- โ I2C ัะธะฝะฐ ะฝะต ะฟะตัะตะณััะถะตะฝะฐ
- โ ะกะธััะตะผะฐ ะฟัะพะดะพะปะถะฐะตั ัะฐะฑะพัะฐัั ั ะฟะพะดะบะปััะตะฝะฝัะผะธ ะดะฐััะธะบะฐะผะธ

---

## ๐ ะกัะฐะฒะฝะตะฝะธะต ะะ/ะะะกะะ

### ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั:

| ะะฐัะฐะผะตัั | ะะ | ะะะกะะ | ะะทะผะตะฝะตะฝะธะต |
|----------|-----|-------|-----------|
| **SPI queue depth** | 10 | 30 | **+200%** |
| **SPI max transfer** | 38.4 KB | 48 KB | **+25%** |
| **LVGL buffer lines** | 60 | 40 | **-33% (ะฑััััะตะต!)** |
| **LVGL buffer size** | 28.8 KB | 19.2 KB | **-33%** |
| **Notif queue** | 5 | 20 | **+300%** |
| **I2C error spam** | ะกะพัะฝะธ/ัะตะบ | 1/60ัะตะบ | **-99.9%** |
| **Display timeout** | 100 ะผั | 500 ะผั | **+400%** |
| **Watchdog timeouts** | ะะฐ โ | ะะตั โ | **ะัะฟัะฐะฒะปะตะฝะพ** |

### ะะฐะผััั:

| ะขะธะฟ | ะะทะผะตะฝะตะฝะธะต | ะัะพะณะพ |
|-----|-----------|-------|
| **DRAM** | -19.2 KB (ะผะตะฝััะต ะฑััะตัั LVGL) | 231 โ **212 KB** (62%) โ |
| **PSRAM** | -19.2 KB (ะผะตะฝััะต ะฑััะตัั LVGL) | 76 โ **57 KB** |
| **Flash** | ะะตะท ะธะทะผะตะฝะตะฝะธะน | **1.32 MB** (34%) โ |

---

## ๐ฏ ะงัะพ ะธะทะผะตะฝะธะปะพัั ะฒ ัะฐะฑะพัะต ัะธััะตะผั

### Sensor Manager:

**ะะ:**
- ะััะฐะตััั ัะธัะฐัั ะฒัะต ะดะฐััะธะบะธ ะฒัะตะณะดะฐ
- ะัะธ ะพัะธะฑะบะต retry 3 ัะฐะทะฐ = 9 ะฟะพะฟััะพะบ/ััะตะฝะธะต
- ะะฐะถะดะฐั ะพัะธะฑะบะฐ โ ัะฒะตะดะพะผะปะตะฝะธะต
- ะะตะทัะปััะฐั: **ัะพัะฝะธ ะพัะธะฑะพะบ ะฒ ัะตะบัะฝะดั**

**ะะะกะะ:**
- โ ะัะพะฒะตััะตั ะดะพัััะฟะฝะพััั ะดะฐััะธะบะฐ
- โ ะัะบะปััะฐะตั ะฟัะพะฑะปะตะผะฝัะต ะดะฐััะธะบะธ ะฝะฐ 60 ัะตะบัะฝะด
- โ ะะดะฝะพ ะฟัะตะดัะฟัะตะถะดะตะฝะธะต ะฟัะธ ะพัะบะปััะตะฝะธะธ
- โ ะะฒัะพะผะฐัะธัะตัะบะธ ะฟััะฐะตััั ะฒะบะปััะธัั ัะตัะตะท 60 ัะตะบัะฝะด
- ะะตะทัะปััะฐั: **1 ะฟัะตะดัะฟัะตะถะดะตะฝะธะต ะฒ ะผะธะฝััั**

### LVGL Rendering:

**ะะ:**
- ะััะตัั 60 ัััะพะบ โ ะดะพะปะณะฐั ะพััะธัะพะฒะบะฐ
- SPI ะพัะตัะตะดั ะฟะตัะตะฟะพะปะฝัะตััั
- Watchdog timeout

**ะะะกะะ:**
- โ ะััะตัั 40 ัััะพะบ โ ะฑััััะฐั ะพััะธัะพะฒะบะฐ (-33% ะฒัะตะผะตะฝะธ)
- โ SPI ะพัะตัะตะดั x3 โ ะฝะต ะฟะตัะตะฟะพะปะฝัะตััั
- โ WDT ัะฑัะฐััะฒะฐะตััั ัะตะณัะปััะฝะพ โ ะฝะตั timeout

---

## ๐ ะัะต ะธะทะผะตะฝะตะฝะฝัะต ัะฐะนะปั

1. **`components/lcd_ili9341/lcd_ili9341.c`**
   - ะะพะฑะฐะฒะปะตะฝ `#include "esp_task_wdt.h"`
   - ะะพะฑะฐะฒะปะตะฝั `esp_task_wdt_reset()` ะฒ `lvgl_task_handler()`
   - SPI ะพัะตัะตะดั: 10 โ 30
   - SPI max transfer: 38.4 KB โ 48 KB
   - LVGL ะฑััะตัั: 60 ัััะพะบ โ 40 ัััะพะบ

2. **`components/sensor_manager/sensor_manager.c`**
   - ะะพะฑะฐะฒะปะตะฝ ะผะตัะฐะฝะธะทะผ ะพัะบะปััะตะฝะธั ะฟัะพะฑะปะตะผะฝัั ะดะฐััะธะบะพะฒ
   - ะกัะตััะธะบะธ `consecutive_errors[]`
   - ะขะฐะนะผะตัั `sensor_disabled_until[]`
   - ะคัะฝะบัะธั `is_sensor_enabled()`
   - ะัะพะฒะตัะบะธ ะฒะพ ะฒัะตั `read_*_with_retry()`

3. **`components/lvgl_ui/lvgl_ui.c`**
   - Display task timeout: 100 ะผั โ 500 ะผั

4. **`components/lvgl_ui/screens/notification_screen.c`**
   - Notif queue: 5 โ 20

---

## โก ะะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต ัะธััะตะผั

### ะัะธ ะทะฐะฟััะบะต:

```
I (xxx) HYDRO_MAIN: [INIT] System initialization starting...
I (xxx) LCD: Display buffer 1 allocated in PSRAM: 19200 bytes (40 lines)
I (xxx) LCD: Display buffer 2 allocated in PSRAM: 19200 bytes (40 lines)
I (xxx) HYDRO_MAIN:   [OK] Network Manager initialized
I (xxx) NETWORK: WiFi connected! IP: 192.168.x.x
```

### ะัะธ ัะฐะฑะพัะต ั ะฝะตะฟะพะดะบะปััะตะฝะฝัะผะธ ะดะฐััะธะบะฐะผะธ:

```
W (10000) SENSOR_MGR: Sensor 0 disabled until 70000 ms (too many errors)
W (70000) SENSOR_MGR: Sensor 0 disabled until 130000 ms (too many errors)
(ะบะฐะถะดัะต 60 ัะตะบัะฝะด ะฒะผะตััะพ ัะพัะตะฝ ัะฐะท ะฒ ัะตะบัะฝะดั)
```

### UI ัะฐะฑะพัะฐ:

```
(ะะะข ะฟัะตะดัะฟัะตะถะดะตะฝะธะน "Failed to get LVGL lock")
(ะะะข ะพัะธะฑะพะบ "spi transmit failed")
(ะะะข watchdog timeouts)
โ ะะปะฐะฒะฝะฐั ะพััะธัะพะฒะบะฐ
โ ะัะทัะฒัะธะฒัะน ัะฝะบะพะดะตั
```

---

## ๐ ะะฐะบ ะฟัะพัะตััะธัะพะฒะฐัั

### 1. ะััะฐะฝะพะฒะธัะต ัะตะบััะธะน ะผะพะฝะธัะพั:
ะ ัะตัะผะธะฝะฐะปะต ั ะผะพะฝะธัะพัะพะผ ะฝะฐะถะผะธัะต: `Ctrl+C`

### 2. ะัะพัะตะนัะต ะฝะพะฒัั ะฒะตััะธั:
```bash
idf.py -p COM5 flash monitor
```

### 3. ะัะพะฒะตัััะต ะปะพะณะธ:

#### โ ะะพะปะถะฝะพ ะฑััั:
- ะะฝะธัะธะฐะปะธะทะฐัะธั LCD ั ะฑััะตัะฐะผะธ 40 ัััะพะบ
- Network Manager initialized
- WiFi connected (ะตัะปะธ ะตััั ัะพััะฐะฝะตะฝะฝะฐั ัะตัั)
- ะะดะธะฝะธัะฝัะต ะฟัะตะดัะฟัะตะถะดะตะฝะธั ะพะฑ ะพัะบะปััะตะฝะธะธ ะดะฐััะธะบะพะฒ

#### โ ะะ ะดะพะปะถะฝะพ ะฑััั:
- Watchdog timeout
- "spi transmit failed"
- "Failed to get LVGL lock" (ะผะฝะพะถะตััะฒะตะฝะฝัะต)
- ะกะพัะฝะธ I2C ะพัะธะฑะพะบ

### 4. ะขะตัั UI:
- ะัััะธัะต ัะฝะบะพะดะตั - ะดะพะปะถะฝะพ ะฑััั **ะฟะปะฐะฒะฝะพ**
- ะะตัะตะบะปััะฐะนัะต ัะบัะฐะฝั - **ะฑะตะท ะปะฐะณะพะฒ**
- ะัะบัะพะนัะต WiFi - **ะฑััััะพ**
- ะกะบะฐะฝะธััะนัะต ัะตัะธ - **UI ะฝะต ะทะฐะฒะธัะฐะตั**

---

## ๐ ะะตัะฐะปัะฝะฐั ััะตะผะฐ ะธัะฟัะฐะฒะปะตะฝะธะน

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ               ะะะะะะะะ: Mutex Contention                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ                                                           โ
โ  ะะ:                                                      โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ  โ LVGL Timer Task (lvgl_lock(-1))         โ             โ
โ  โ   โ                                      โ             โ
โ  โ lv_timer_handler()                       โ             โ
โ  โ   โ                                      โ             โ
โ  โ lvgl_flush_cb()                          โ             โ
โ  โ   โ                                      โ             โ
โ  โ esp_lcd_panel_draw_bitmap()              โ             โ
โ  โ   โ                                      โ             โ
โ  โ SPI ะฟะตัะตะดะฐัะฐ (ะะะะะะะะ!)                 โ             โ
โ  โ   โ โ๏ธ ะะตัะถะธะผ ะผัััะตะบั 500+ ะผั!           โ             โ
โ  โ wait_for_flushing()  โ WATCHDOG TIMEOUT  โ             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ             โ ะะะะะะะะะะ                                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ  โ Display Task (lvgl_lock(100 ะผั))         โ             โ
โ  โ   โ                                      โ             โ
โ  โ โ TIMEOUT - ะผัััะตะบั ะทะฐะฝัั!              โ             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ                                                           โ
โ  ะะะกะะ:                                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ  โ LVGL Timer Task                          โ             โ
โ  โ   โ                                      โ             โ
โ  โ esp_task_wdt_reset() โ ะะะะะ โ          โ             โ
โ  โ   โ                                      โ             โ
โ  โ lv_timer_handler()                       โ             โ
โ  โ   โ (ะฑััะตัั 40 ัััะพะบ ะฒะผะตััะพ 60)          โ             โ
โ  โ SPI ะฟะตัะตะดะฐัะฐ (ะะซะกะขะะะ ะฝะฐ 33%)            โ             โ
โ  โ   โ (ะพัะตัะตะดั 30 ะฒะผะตััะพ 10)               โ             โ
โ  โ esp_task_wdt_reset() โ ะะะะะ โ          โ             โ
โ  โ   โ                                      โ             โ
โ  โ ะัะฒะพะฑะพะถะดะตะฝะธะต ะผัััะตะบัะฐ (~200 ะผั)          โ             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ             โ                                             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ  โ Display Task (lvgl_lock(500 ะผั))         โ             โ
โ  โ   โ                                      โ             โ
โ  โ โ ะฃัะฟะตะฒะฐะตั ะฟะพะปััะธัั ะผัััะตะบั!            โ             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ             โ
โ                                                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะขะฐะฑะปะธัะฐ ะธัะฟัะฐะฒะปะตะฝะธะน

| # | ะัะพะฑะปะตะผะฐ | ะคะฐะนะป | ะกััะพะบะฐ | ะัะฟัะฐะฒะปะตะฝะธะต | ะะตะทัะปััะฐั |
|---|----------|------|--------|-------------|-----------|
| 1 | Watchdog timeout | lcd_ili9341.c | 152, 162 | +esp_task_wdt_reset() | โ ะะตั timeout |
| 2 | SPI queue overflow | lcd_ili9341.c | 327 | trans_queue_depth: 10โ30 | โ ะะต ะฟะตัะตะฟะพะปะฝัะตััั |
| 3 | ะะพะปะณะฐั ะพััะธัะพะฒะบะฐ | lcd_ili9341.c | 228, 238 | ะััะตัั: 60โ40 ัััะพะบ | โ ะััััะตะต ะฝะฐ 33% |
| 4 | SPI transfer limit | lcd_ili9341.c | 303 | max_transfer: 38โ48 KB | โ ะะพะปััะต ะดะฐะฝะฝัั |
| 5 | Mutex timeout | lvgl_ui.c | 670 | Timeout: 100โ500 ะผั | โ ะฃัะฟะตะฒะฐะตั |
| 6 | Notif overflow | notification_screen.c | 58 | Queue: 5โ20 | โ ะะต ะฟะตัะตะฟะพะปะฝัะตััั |
| 7 | I2C spam | sensor_manager.c | 54-57 | ะัะบะปััะตะฝะธะต ะดะฐััะธะบะพะฒ | โ ะะตั ัะฟะฐะผะฐ |

---

## โ ะัะพะณะพะฒัะน ััะฐััั

### ะะฐะผััั:

```
DRAM:  212 KB / 328 KB (62%) โ ะัะปะธัะฝะพ! (ะตัะต ะพัะฒะพะฑะพะดะธะปะธ 19 KB)
PSRAM:  57 KB / 2-8 MB  (<1%) โ ะะฝะพะณะพ ัะฒะพะฑะพะดะฝะพ
Flash: 1.32 MB / 3.83 MB (34%) โ ะัะปะธัะฝัะน ะทะฐะฟะฐั
```

### ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั:

```
โ Watchdog: ะะต ััะฐะฑะฐััะฒะฐะตั
โ SPI: ะะต ะฟะตัะตะฟะพะปะฝัะตััั
โ LVGL: ะะปะฐะฒะฝะฐั ะพััะธัะพะฒะบะฐ
โ UI: ะัะทัะฒัะธะฒัะน
โ WiFi: ะะฐะฑะพัะฐะตั
โ ะะฐััะธะบะธ: ะะพะดะบะปััะตะฝะฝัะต ัะฐะฑะพัะฐัั, ะฝะตะฟะพะดะบะปััะตะฝะฝัะต ะฝะต ัะฟะฐะผัั
```

### ะัะพะฑะปะตะผั:

```
โ ะะะข ะบัะธัะธัะฝัั ะฟัะพะฑะปะตะผ
โ๏ธ  ะะฐััะธะบะธ 0x44 ะธ 0x0A ะฝะต ะฟะพะดะบะปััะตะฝั (ััะพ ะฝะพัะผะฐะปัะฝะพ)
```

---

## ๐ ะะพัะพะฒะพ ะบ ะฟัะพัะธะฒะบะต!

**ะะพะผะฐะฝะดะฐ:**
```bash
# 1. ะััะฐะฝะพะฒะธัะต ัะตะบััะธะน ะผะพะฝะธัะพั (Ctrl+C)
# 2. ะัะพัะตะนัะต:
idf.py -p COM5 flash monitor
```

**ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:**
- โ ะะตั ะฟัะตะดัะฟัะตะถะดะตะฝะธะน LVGL lock
- โ ะะตั SPI ะพัะธะฑะพะบ
- โ ะะตั watchdog timeouts
- โ ะะธะฝะธะผัะผ I2C ะพัะธะฑะพะบ (ัะพะปัะบะพ ะฟัะธ ะพัะบะปััะตะฝะธะธ ะดะฐััะธะบะฐ)
- โ WiFi ะฟะพะดะบะปััะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- โ UI ะฟะปะฐะฒะฝัะน ะธ ะพัะทัะฒัะธะฒัะน

---

**ะะฒัะพั:** AI Assistant  
**ะะฐัะฐ:** 2025-10-16  
**ะะตััะธั:** 3.0.0-advanced  
**ะกัะฐััั:** โ ะะกะ ะะะะะะะะซ ะะะจะะะซ - ะะะขะะะ ะ ะะะะะะะจะะฃ!

