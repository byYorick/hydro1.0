# ü§ñ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–õ–Ø AI-–ê–°–°–ò–°–¢–ï–ù–¢–û–í

**–ü—Ä–æ–µ–∫—Ç:** Hydro System 1.0 (ESP32-S3)  
**–î–∞—Ç–∞:** 16 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** ESP-IDF v5.5.1  
**–û–°:** Windows 10

---

## üìã –í–ê–ñ–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

### –≠—Ç–æ –ø—Ä–æ–µ–∫—Ç ESP-IDF –¥–ª—è ESP32-S3
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **ESP-IDF v5.5.1** (–Ω–µ Arduino!)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **LVGL 9.2.2** (–Ω–µ 8.x!) ‚ö†Ô∏è
- –Ø–∑—ã–∫: **C** (–Ω–µ C++)
- Build —Å–∏—Å—Ç–µ–º–∞: **CMake + Ninja**
- IDE: VSCode —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º ESP-IDF

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—â–∞–µ—Ç—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–Ω–∞ —Ä—É—Å—Å–∫–æ–º**
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –∏–ª–∏ —Ä—É—Å—Å–∫–æ–º
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ª–æ–≥–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º

---

## üîß –ù–ê–°–¢–†–û–ô–ö–ê –û–ö–†–£–ñ–ï–ù–ò–Ø

### –ö–æ–º–∞–Ω–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

```batch
C:\Windows\system32\cmd.exe /k ""C:\Espressif\idf_cmd_init.bat" esp-idf-29323a3f5a0574597d6dbaa0af20c775"
```

**–ß—Ç–æ –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç:**
1. –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç Python virtual environment (3.11.2)
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç IDF_PATH –≤ `C:\Espressif\frameworks\esp-idf-v5.5.1`
3. –î–æ–±–∞–≤–ª—è–µ—Ç toolchain –≤ PATH (xtensa-esp-elf-gcc)
4. –î–µ–ª–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥—ã `idf.py`, `esptool.py`

### –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

```
C:\Users\admin\2\hydro1.0
```

**–í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—à—å—Å—è –≤ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏!**

---

## üöÄ –û–°–ù–û–í–ù–´–ï –ö–û–ú–ê–ù–î–´

### 1. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```batch
cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py build"
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã–≤–æ–¥–∞:**
- ‚úÖ `Project build complete` ‚Üí —É—Å–ø–µ—Ö
- ‚ùå `ninja: build stopped` ‚Üí –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
- ‚ö†Ô∏è Warnings ‚Üí –æ–±—ã—á–Ω–æ –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å (`-Wunused-variable`, `-Wunused-function`)
- ‚ùå `implicit declaration` ‚Üí –ö–†–ò–¢–ò–ß–ù–û, –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

**–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:**
```
fatal error: some_header.h: No such file or directory
```
‚Üí –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ CMakeLists.txt: `PRIV_REQUIRES component_name`

```
undefined reference to `some_function'
```
‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ .c —Ñ–∞–π–ª–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ CMakeLists.txt

### 2. –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ COM –ø–æ—Ä—Ç–∞

```batch
c:\Users\admin\2\hydro1.0\free_com5.bat
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–µ—Ä–µ–¥ –ø—Ä–æ—à–∏–≤–∫–æ–π, –µ—Å–ª–∏ –±—ã–ª –∑–∞–ø—É—â–µ–Ω monitor
- –ü—Ä–∏ –æ—à–∏–±–∫–µ `Could not open COM5, the port is busy`

### 3. –ü—Ä–æ—à–∏–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

```batch
cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py -p COM5 flash"
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã–≤–æ–¥–∞:**
- ‚úÖ `Connecting....` ‚Üí –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –∂–¥—ë–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ `Chip is ESP32-S3 (QFN56) (revision v0.2)` ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —á–∏–ø
- ‚úÖ `PSRAM 8MB` ‚Üí –ø–∞–º—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ `Writing at 0x...` (0-100%) ‚Üí –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏
- ‚úÖ `Done` ‚Üí –ø—Ä–æ—à–∏–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå `Could not open COM5` ‚Üí –∑–∞–ø—É—Å—Ç–∏—Ç—å `free_com5.bat`
- ‚ùå `Timed out waiting` ‚Üí –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å USB, –Ω–∞–∂–∞—Ç—å BOOT –Ω–∞ –ø–ª–∞—Ç–µ

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

```batch
cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py -p COM5 monitor"
```

**–ò–ª–∏ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ (–ø—Ä–æ—à–∏–≤–∫–∞ + –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥):**

```batch
cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py -p COM5 flash monitor"
```

### 5. –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ (–ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö)

```batch
cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py fullclean && idf.py build"
```

---

## üìä –ê–ù–ê–õ–ò–ó –õ–û–ì–û–í

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ ESP-IDF

```
<–£–†–û–í–ï–ù–¨> (<–í–†–ï–ú–Ø_–ú–°>) <–¢–≠–ì>: <–°–û–û–ë–©–ï–ù–ò–ï>
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```
I (1234) MAIN: –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞          # INFO
W (2345) SENSOR: –î–∞—Ç—á–∏–∫ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç      # WARNING
E (3456) I2C: –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è              # ERROR
D (4567) LVGL: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI              # DEBUG
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å

#### 1. Watchdog Timeout (–û–ß–ï–ù–¨ –ö–†–ò–¢–ò–ß–ù–û!)

```
E (90310) task_wdt: Task watchdog got triggered
E (90310) task_wdt: CPU 1: autotune_upd
```

**–†–µ—à–µ–Ω–∏–µ:**
```c
while (running) {
    esp_task_wdt_reset();  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤–∏—Ç—å!
    // ... —Ä–∞–±–æ—Ç–∞ –∑–∞–¥–∞—á–∏ ...
    vTaskDelay(pdMS_TO_TICKS(100));
}
```

#### 2. Stack Overflow

```
***ERROR*** A stack overflow in task task_name has been detected.
```

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–µ–∫: `xTaskCreate(..., 4096, ...)` ‚Üí `8192` –∏–ª–∏ –±–æ–ª—å—à–µ

#### 3. Memory Leak (—É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏)

```
I (60000) heap: Free heap: 150000 bytes
I (120000) heap: Free heap: 145000 bytes  # –£–º–µ–Ω—å—à–∞–µ—Ç—Å—è!
I (180000) heap: Free heap: 140000 bytes
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ `malloc()` ‚Üí –µ—Å—Ç—å –ª–∏ `free()`?
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å LVGL –æ–±—ä–µ–∫—Ç—ã ‚Üí –¥–æ–±–∞–≤–∏—Ç—å `LV_EVENT_DELETE` –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

#### 4. Assertion Failed

```
assert failed: pvTaskIncrementMutexHeldCount tasks.c:4920
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º—å—é—Ç–µ–∫—Å–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `lv_lock()` / `lv_unlock()` –ø–∞—Ä—ã

---

## üèóÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```
hydro1.0/
‚îú‚îÄ‚îÄ main/                    # –ì–ª–∞–≤–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ app_main.c          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ system_config.h     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ CMakeLists.txt
‚îú‚îÄ‚îÄ components/              # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ adaptive_pid/       # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π PID –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ lvgl_ui/            # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (LVGL)
‚îÇ   ‚îú‚îÄ‚îÄ encoder/            # –î—Ä–∞–π–≤–µ—Ä —ç–Ω–∫–æ–¥–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ screen_manager/     # –ú–µ–Ω–µ–¥–∂–µ—Ä —ç–∫—Ä–∞–Ω–æ–≤ (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –≤ lvgl_ui)
‚îÇ   ‚îú‚îÄ‚îÄ sht3x/              # –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ trema_ph/           # –î–∞—Ç—á–∏–∫ pH
‚îÇ   ‚îú‚îÄ‚îÄ trema_ec/           # –î–∞—Ç—á–∏–∫ EC
‚îÇ   ‚îî‚îÄ‚îÄ ...                 # –î—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ CMakeLists.txt          # –ì–ª–∞–≤–Ω—ã–π CMake —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ sdkconfig               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ partitions.csv          # –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–∑–¥–µ–ª–æ–≤ flash
‚îî‚îÄ‚îÄ BUILD_FLASH_MONITOR_ALGORITHM.md  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
```

### –í–∞–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### üéØ –ú–ï–ù–ï–î–ñ–ï–†–´ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!)

##### 1. **sensor_manager** - –ß—Ç–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤ (‚≠ê NEW!)
```c
esp_err_t sensor_manager_init(void);
esp_err_t sensor_manager_read_all(sensor_data_t *data);
esp_err_t sensor_manager_get_cached_data(sensor_data_t *data);
esp_err_t sensor_manager_read_ph(float *ph);
esp_err_t sensor_manager_read_ec(float *ec);
bool sensor_manager_is_sensor_healthy(sensor_type_t sensor);
esp_err_t sensor_manager_calibrate_ph(float measured, float actual);
```

##### 2. **config_manager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
```c
esp_err_t config_manager_init(void);
esp_err_t config_load(system_config_t *config);
esp_err_t config_save(const system_config_t *config);
esp_err_t config_manager_get_u32(const char *key, uint32_t *value);
esp_err_t config_manager_set_u32(const char *key, uint32_t value);
```

##### 3. **pump_manager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 6 –Ω–∞—Å–æ—Å–∞–º–∏
```c
esp_err_t pump_manager_init(void);
esp_err_t pump_manager_set_pid_tunings(pump_index_t pump, float kp, float ki, float kd);
esp_err_t pump_manager_compute_and_execute(pump_index_t pump, float current, float target);
esp_err_t pump_manager_run_direct(pump_index_t pump, uint32_t duration_ms);
esp_err_t pump_manager_get_stats(pump_index_t pump, pump_stats_t *stats);
```

##### 4. **screen_manager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞–º–∏
```c
esp_err_t screen_manager_init(const screen_manager_config_t *config);
esp_err_t screen_show(const char *screen_id, void *params);
esp_err_t screen_hide(const char *screen_id);
esp_err_t screen_go_back(void);
esp_err_t screen_go_home(void);
```

##### 5. **network_manager** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WiFi
```c
esp_err_t network_manager_init(void);
esp_err_t network_manager_connect(const char *ssid, const char *password);
esp_err_t network_manager_disconnect(void);
```

#### üîß –ö–û–ù–¢–†–û–õ–õ–ï–†–´

##### 1. **ph_ec_controller** - –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏—è pH/EC
- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `pump_manager`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∏ —Ä—É—á–Ω–æ–π —Ä–µ–∂–∏–º
- PID —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

##### 2. **adaptive_pid** - –°–∞–º–æ–æ–±—É—á–∞—é—â–∏–π—Å—è PID
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤ –Ω–∞ 1-3 —á–∞—Å–∞
- –£–ø—Ä–µ–∂–¥–∞—é—â–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è
- –û–±—É—á–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–Ω–æ–π –µ–º–∫–æ—Å—Ç–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ NVS

##### 3. **pid_auto_tuner** - –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PID
- Ziegler-Nichols –º–µ—Ç–æ–¥
- Relay –º–µ—Ç–æ–¥

#### üîî –°–ò–°–¢–ï–ú–´

##### 1. **notification_system** - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```c
esp_err_t notification_system_init(uint32_t max_notifications);
esp_err_t notification_system(notification_type_t type, const char *message, notification_source_t source);
uint32_t notification_get_unread_count(void);
```

##### 2. **error_handler** - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```c
esp_err_t error_handler_init(bool enable_popups);
void error_handler_report(error_code_t code, error_severity_t severity, const char *message);
```

##### 3. **data_logger** - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```c
esp_err_t data_logger_init(uint32_t max_entries);
esp_err_t data_logger_log_sensor_data(float ph, float ec, float temp, float humidity);
esp_err_t data_logger_log_pump_action(pump_index_t pump, bool started, const char *reason);
```

##### 4. **task_scheduler** - –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- Cron-like —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–∞–¥–∞—á–∏

##### 5. **system_interfaces** - Adapter pattern
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –∞–∫—Ç—É–∞—Ç–æ—Ä–æ–≤
- –£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### üîå –î–ê–¢–ß–ò–ö–ò

- **sht3x** - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–≤–ª–∞–∂–Ω–æ—Å—Ç—å (I2C 0x44)
- **ccs811** - CO2/VOC (I2C 0x5A)
- **trema_ph** - pH (I2C 0x0A)
- **trema_ec** - EC/TDS (I2C 0x08)
- **trema_lux** - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å (I2C 0x12)

#### ‚öôÔ∏è –ê–ö–¢–£–ê–¢–û–†–´

- **6 –Ω–∞—Å–æ—Å–æ–≤** - pH UP/DOWN, EC A/B/C, WATER (GPIO 1,2,3,7,8,16)
- **4 —Ä–µ–ª–µ** - –°–≤–µ—Ç, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä, –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å, —Ä–µ–∑–µ—Ä–≤ (GPIO 19,20,26,27)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã (—Å—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        app_main.c                           ‚îÇ
‚îÇ                    (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞)                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç
                         ‚Üì
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ         –ú–ï–ù–ï–î–ñ–ï–†–´ (Managers)           ‚îÇ
        ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê   ‚îÇ
        ‚îÇ  ‚Ä¢ screen_manager    - —ç–∫—Ä–∞–Ω—ã UI       ‚îÇ
        ‚îÇ  ‚Ä¢ pump_manager      - –Ω–∞—Å–æ—Å—ã          ‚îÇ
        ‚îÇ  ‚Ä¢ config_manager    - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏/NVS   ‚îÇ
        ‚îÇ  ‚Ä¢ notification_sys  - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è     ‚îÇ
        ‚îÇ  ‚Ä¢ error_handler     - –æ—à–∏–±–∫–∏          ‚îÇ
        ‚îÇ  ‚Ä¢ task_scheduler    - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫     ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ                       ‚îÇ
             ‚îÇ –∏—Å–ø–æ–ª—å–∑—É—é—Ç            ‚îÇ —É–ø—Ä–∞–≤–ª—è—é—Ç
             ‚Üì                       ‚Üì
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ   UI –ö–û–ú–ü–û–ù–ï–ù–¢–´  ‚îÇ    ‚îÇ  –ê–ü–ü–ê–†–ê–¢–ù–´–ï –î–†–ê–ô–í–ï–†–´ ‚îÇ
  ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  ‚îÇ    ‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  ‚îÇ
  ‚îÇ  ‚Ä¢ –≠–∫—Ä–∞–Ω—ã LVGL   ‚îÇ    ‚îÇ  ‚Ä¢ trema_ph (I2C)    ‚îÇ
  ‚îÇ  ‚Ä¢ –í–∏–¥–∂–µ—Ç—ã       ‚îÇ    ‚îÇ  ‚Ä¢ trema_ec (I2C)    ‚îÇ
  ‚îÇ  ‚Ä¢ –≠–Ω–∫–æ–¥–µ—Ä       ‚îÇ    ‚îÇ  ‚Ä¢ sht3x (I2C)       ‚îÇ
  ‚îÇ  ‚Ä¢ Popup         ‚îÇ    ‚îÇ  ‚Ä¢ –†–µ–ª–µ (GPIO)       ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ü–†–ê–í–ò–õ–û: –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–π —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã!
         –ù–ï –≤—ã–∑—ã–≤–∞–π –¥—Ä–∞–π–≤–µ—Ä—ã/UI –Ω–∞–ø—Ä—è–º—É—é!
```

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞:**
- `–≠–∫—Ä–∞–Ω ‚Üí screen_manager ‚Üí LVGL`
- `–õ–æ–≥–∏–∫–∞ ‚Üí pump_manager ‚Üí GPIO –¥—Ä–∞–π–≤–µ—Ä`
- `–î–∞—Ç—á–∏–∫ ‚Üí sensor_manager ‚Üí I2C –¥—Ä–∞–π–≤–µ—Ä`
- `–û—à–∏–±–∫–∞ ‚Üí error_handler ‚Üí notification_system ‚Üí UI`

---

## üî® –†–ê–ë–û–¢–ê –° –ö–û–î–û–ú

### ‚ö° –í–ê–ñ–ù–û: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏

**–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏!**

#### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã:

1. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º**
   - ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–∞—Ç—á–∏–∫–æ–≤, –Ω–∞—Å–æ—Å–æ–≤ –∏ —Ç.–¥.
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã

2. **–ò—Å–ø–æ–ª—å–∑—É–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:**
   - `sensor_manager` - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤ ‚≠ê NEW!
   - `screen_manager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞–º–∏ LVGL
   - `pump_manager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏
   - `config_manager` - —Ä–∞–±–æ—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (NVS)
   - `notification_system` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - `error_handler` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - `task_scheduler` - –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á

3. **–í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã:

**‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤):**
```c
// –ù–∞–ø—Ä—è–º—É—é –≤–∫–ª—é—á–∞–µ–º –Ω–∞—Å–æ—Å
gpio_set_level(PUMP_PIN, 1);
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (—á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä):**
```c
// –ò—Å–ø–æ–ª—å–∑—É–µ–º pump_manager
pump_manager_start_pump(PUMP_PH_DOWN, duration_ms);
```

**‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–ø—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å NVS):**
```c
nvs_handle_t handle;
nvs_open("storage", NVS_READWRITE, &handle);
nvs_set_u32(handle, "setting", value);
nvs_commit(handle);
nvs_close(handle);
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (—á–µ—Ä–µ–∑ config_manager):**
```c
config_manager_set_u32("setting", value);
config_manager_save();
```

**‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–ø—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞):**
```c
lv_obj_t* screen = lv_obj_create(NULL);
lv_scr_load(screen);
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (—á–µ—Ä–µ–∑ screen_manager):**
```c
screen_manager_show("screen_name");
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É):**
```c
notification_system_show("–ù–∞—Å–æ—Å –∑–∞–ø—É—â–µ–Ω", NOTIFICATION_INFO, 3000);
```

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
- ‚úÖ –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –õ–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- ‚úÖ –ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

1. –°–æ–∑–¥–∞–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ `components/new_component/`
2. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª—ã: `new_component.h`, `new_component.c`, `CMakeLists.txt`

**CMakeLists.txt:**
```cmake
idf_component_register(
    SRCS "new_component.c"
    INCLUDE_DIRS "."
    REQUIRES –¥—Ä—É–≥–∏–µ_–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    PRIV_REQUIRES –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
)
```

3. –î–æ–±–∞–≤—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
```cmake
PRIV_REQUIRES new_component
```

4. **–ï—Å–ª–∏ —ç—Ç–æ –º–µ–Ω–µ–¥–∂–µ—Ä, —Ä–µ–∞–ª–∏–∑—É–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
```c
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
esp_err_t manager_name_init(void);

// –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
esp_err_t manager_name_do_something(params);

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
esp_err_t manager_name_get_state(state_t* out_state);

// –î–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
esp_err_t manager_name_deinit(void);
```

### –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π ESP_LOGx –º–∞–∫—Ä–æ—Å—ã:**
```c
#define TAG "MY_COMPONENT"
ESP_LOGI(TAG, "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è");
ESP_LOGW(TAG, "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ");
ESP_LOGE(TAG, "–û—à–∏–±–∫–∞");
```

2. **–í –¥–ª–∏–Ω–Ω—ã—Ö —Ü–∏–∫–ª–∞—Ö –¥–æ–±–∞–≤–ª—è–π watchdog reset:**
```c
while (1) {
    esp_task_wdt_reset();
    // —Ä–∞–±–æ—Ç–∞
    vTaskDelay(pdMS_TO_TICKS(100));
}
```

3. **–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å LVGL –∏—Å–ø–æ–ª—å–∑—É–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:**
```c
lv_lock();
// —Ä–∞–±–æ—Ç–∞ —Å LVGL –æ–±—ä–µ–∫—Ç–∞–º–∏
lv_unlock();
```

4. **–û—Å–≤–æ–±–æ–∂–¥–∞–π –ø–∞–º—è—Ç—å:**
```c
void* ptr = malloc(100);
// –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
free(ptr);
```

### –¢–∏–ø–∏—á–Ω—ã–µ patterns –≤ –ø—Ä–æ–µ–∫—Ç–µ

#### Screen lifecycle (—ç–∫—Ä–∞–Ω—ã LVGL)
```c
typedef struct {
    screen_base_t base;
    lv_obj_t* container;
    // –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
} my_screen_t;

static void on_create(screen_base_t* base) {
    my_screen_t* screen = (my_screen_t*)base;
    // —Å–æ–∑–¥–∞–Ω–∏–µ UI
}

static void on_show(screen_base_t* base) {
    // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
}

static void on_hide(screen_base_t* base) {
    // –æ—á–∏—Å—Ç–∫–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
}

static void on_destroy(screen_base_t* base) {
    // –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
    free(base);
}
```

---

## ‚ö†Ô∏è –¢–ò–ü–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| **–ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** | **–ù–∞—Ä—É—à–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** | **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä** |
| –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ | –ù–µ—Ç `free()` –¥–ª—è `malloc()` | –î–æ–±–∞–≤–∏—Ç—å `LV_EVENT_DELETE` callbacks |
| Watchdog timeout | –ù–µ—Ç `esp_task_wdt_reset()` | –î–æ–±–∞–≤–∏—Ç—å –≤ —Ü–∏–∫–ª—ã –∑–∞–¥–∞—á |
| Stack overflow | –ú–∞–ª—ã–π —Ä–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞ | –£–≤–µ–ª–∏—á–∏—Ç—å –≤ `xTaskCreate` (4096 ‚Üí 8192) |
| COM –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç | Monitor –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è | –ó–∞–ø—É—Å—Ç–∏—Ç—å `free_com5.bat` |
| –î–≤–æ–π–Ω–æ–π —Ñ–æ–∫—É—Å UI | –†—É—á–Ω–æ–π `set_focused()` | –£–±—Ä–∞—Ç—å, –¥–æ–≤–µ—Ä–∏—Ç—å screen_manager |
| LVGL crash | –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ | –î–æ–±–∞–≤–∏—Ç—å `lv_lock()`/`lv_unlock()` |
| Race condition | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å getter/setter –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Å –º—å—é—Ç–µ–∫—Å–æ–º |
| Implicit declaration | –ù–µ—Ç include | –î–æ–±–∞–≤–∏—Ç—å `#include "header.h"` |
| Undefined reference | –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | –î–æ–±–∞–≤–∏—Ç—å –≤ CMakeLists.txt PRIV_REQUIRES |

---

## üìù –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø AI

### –ü–µ—Ä–µ–¥ –≤–Ω–µ—Å–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- [ ] –ü–æ–Ω—è–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ (ESP-IDF, –Ω–µ Arduino)
- [ ] –ó–Ω–∞—é, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω—É–∂–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- [ ] –ü—Ä–æ—á–∏—Ç–∞–ª —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏–ª, –∫–∞–∫–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞:
- [ ] **–†–∞–±–æ—Ç–∞—é —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã, –ù–ï –Ω–∞–ø—Ä—è–º—É—é —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏**
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é ESP_LOG –¥–ª—è –ª–æ–≥–æ–≤
- [ ] –î–æ–±–∞–≤–ª—è—é `esp_task_wdt_reset()` –≤ —Ü–∏–∫–ª—ã
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é `lv_lock()`/`lv_unlock()` –¥–ª—è LVGL
- [ ] –û—Å–≤–æ–±–æ–∂–¥–∞—é –≤—Å—é –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é —Ä–∞–∑–º–µ—Ä —Å—Ç–µ–∫–∞ –∑–∞–¥–∞—á (–º–∏–Ω–∏–º—É–º 4096)
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é —á–µ—Ä–µ–∑ `notification_system`
- [ ] –û—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —á–µ—Ä–µ–∑ `error_handler`

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- [ ] –ó–∞–ø—É—Å—Ç–∏–ª —Å–±–æ—Ä–∫—É: `idf.py build`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –Ω–µ—Ç –ª–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫
- [ ] –û–±—ä—è—Å–Ω–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª
- [ ] –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ—à–∏–≤–∫–µ: `free_com5.bat` ‚Üí `idf.py -p COM5 flash`

### –ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –ª–æ–≥–æ–≤:
- [ ] –ò—â—É `E (` –¥–ª—è –æ—à–∏–±–æ–∫
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é `task_wdt` ‚Üí watchdog –ø—Ä–æ–±–ª–µ–º—ã
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä—é `Free heap` ‚Üí —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏
- [ ] –ß–∏—Ç–∞—é backtrace –ø—Ä–∏ crash

---

## üéØ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù—É–∂–Ω–æ —á—Ç–æ-—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –∫–æ–¥–µ

```bash
1. –†–µ–¥–∞–∫—Ç–∏—Ä—É—é —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, adaptive_pid.c)
2. –°–±–æ—Ä–∫–∞:
   cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py build"
3. –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ ‚Üí –∏—Å–ø—Ä–∞–≤–ª—è—é ‚Üí –ø–æ–≤—Ç–æ—Ä—è—é —à–∞–≥ 2
4. –û—Å–≤–æ–±–æ–∂–¥–∞—é –ø–æ—Ä—Ç:
   c:\Users\admin\2\hydro1.0\free_com5.bat
5. –ü—Ä–æ—à–∏–≤–∞—é:
   cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py -p COM5 flash"
6. –ú–æ–Ω–∏—Ç–æ—Ä—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py -p COM5 monitor"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

```bash
1. –û—Å–≤–æ–±–æ–∂–¥–∞—é –ø–æ—Ä—Ç:
   c:\Users\admin\2\hydro1.0\free_com5.bat
2. –ó–∞–ø—É—Å–∫–∞—é –º–æ–Ω–∏—Ç–æ—Ä:
   cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py -p COM5 monitor"
3. –ß–∏—Ç–∞—é –ª–æ–≥–∏, –∏—â—É –æ—à–∏–±–∫–∏
4. Ctrl+] –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –º–æ–Ω–∏—Ç–æ—Ä–∞
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ë—ã—Å—Ç—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è (–∫–æ–¥ ‚Üí –ø—Ä–æ—à–∏–≤–∫–∞ ‚Üí –º–æ–Ω–∏—Ç–æ—Ä)

```bash
cmd /c "C:\Espressif\idf_cmd_init.bat esp-idf-29323a3f5a0574597d6dbaa0af20c775 >nul 2>&1 && cd c:\Users\admin\2\hydro1.0 && idf.py build && c:\Users\admin\2\hydro1.0\free_com5.bat && idf.py -p COM5 flash monitor"
```

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### –§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:
1. `BUILD_FLASH_MONITOR_ALGORITHM.md` - –ü–æ–ª–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã
2. `–ö–ê–ö_–°–û–ë–†–ê–¢–¨_–ò_–ü–†–û–®–ò–¢–¨.md` - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
3. `ADAPTIVE_PID_USER_GUIDE.md` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–º—É PID
4. `components/error_handler/ERROR_CODES_RU.md` - –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ ESP-IDF:
- [ESP-IDF Programming Guide](https://docs.espressif.com/projects/esp-idf/en/v5.5.1/)
- [FreeRTOS API](https://www.freertos.org/a00106.html)
- [LVGL 9.2 Documentation](https://docs.lvgl.io/9.2/)

---

## üö® –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–ê–í–ò–õ–ê

1. **–í–°–ï–ì–î–ê** —Ä–∞–±–æ—Ç–∞–π —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã, –ù–ï –¥–µ–ª–∞–π –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º
   - –ò—Å–ø–æ–ª—å–∑—É–π `sensor_manager`, `pump_manager`, `screen_manager`, `config_manager` –∏ —Ç.–¥.
   - –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
2. **–ò–°–ü–û–õ–¨–ó–£–ô LVGL 9.2 API**, –ù–ï 8.x!
   - –ü—Ä–æ–≤–µ—Ä—è–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: https://docs.lvgl.io/9.2/
   - API –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç LVGL 8.x
3. **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π Arduino —Ñ—É–Ω–∫—Ü–∏–∏ (`digitalWrite`, `analogRead`, –∏ —Ç.–¥.)
4. **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑—É–π ESP-IDF API (`gpio_set_level`, `adc_read`, –∏ —Ç.–¥.)
5. **–í–°–ï–ì–î–ê** –ø—Ä–æ–≤–µ—Ä—è–π return codes ESP-IDF —Ñ—É–Ω–∫—Ü–∏–π
6. **–ù–ò–ö–û–ì–î–ê** –Ω–µ –±–ª–æ–∫–∏—Ä—É–π –∑–∞–¥–∞—á–∏ –Ω–∞–¥–æ–ª–≥–æ (–∏—Å–ø–æ–ª—å–∑—É–π `vTaskDelay`)
7. **–í–°–ï–ì–î–ê** –¥–æ–±–∞–≤–ª—è–π `esp_task_wdt_reset()` –≤ –¥–ª–∏–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã
8. **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑—É–π `lv_lock()`/`lv_unlock()` –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å LVGL –∏–∑ –∑–∞–¥–∞—á
9. **–í–°–ï–ì–î–ê** –æ—Ç–≤–µ—á–∞–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

---

## ‚úÖ –ü–†–ò–ú–ï–†–´ –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –ö–û–î–ê

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ FreeRTOS
```c
void my_task(void* arg) {
    const char* TAG = "MY_TASK";
    ESP_LOGI(TAG, "–ó–∞–¥–∞—á–∞ –∑–∞–ø—É—â–µ–Ω–∞");
    
    while (1) {
        esp_task_wdt_reset();  // –°–±—Ä–æ—Å watchdog
        
        // –†–∞–±–æ—Ç–∞ –∑–∞–¥–∞—á–∏
        ESP_LOGI(TAG, "Tick");
        
        vTaskDelay(pdMS_TO_TICKS(1000));  // 1 —Å–µ–∫—É–Ω–¥–∞
    }
}

// –í app_main():
xTaskCreate(my_task, "my_task", 4096, NULL, 5, NULL);
```

### –†–∞–±–æ—Ç–∞ —Å LVGL –∏–∑ –∑–∞–¥–∞—á–∏
```c
void update_ui_task(void* arg) {
    while (1) {
        esp_task_wdt_reset();
        
        lv_lock();  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!
        lv_label_set_text(label, "–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç");
        lv_unlock();  // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!
        
        vTaskDelay(pdMS_TO_TICKS(100));
    }
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ESP-IDF
```c
esp_err_t err = i2c_master_cmd_begin(I2C_NUM_0, cmd, pdMS_TO_TICKS(1000));
if (err != ESP_OK) {
    ESP_LOGE(TAG, "I2C error: %s", esp_err_to_name(err));
    return err;
}
```

### –†–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã (–í–ê–ñ–ù–û!)

#### –ß—Ç–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ sensor_manager (‚≠ê NEW!)
```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–æ–≤
float ph, ec;
trema_ph_read(&ph);
trema_ec_read(&ec);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ sensor_manager (—Å retry –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º)
sensor_data_t data;
esp_err_t ret = sensor_manager_read_all(&data);
if (ret == ESP_OK) {
    if (data.valid[SENSOR_INDEX_PH]) {
        ESP_LOGI(TAG, "pH: %.2f", data.ph);
    }
    if (data.valid[SENSOR_INDEX_EC]) {
        ESP_LOGI(TAG, "EC: %.2f", data.ec);
    }
}

// ‚úÖ –ë–´–°–¢–†–´–ô –î–û–°–¢–£–ü - –∏–∑ –∫—ç—à–∞ –±–µ–∑ I2C
sensor_data_t cached;
sensor_manager_get_cached_data(&cached);
update_display(cached.temperature, cached.humidity);

// ‚úÖ –ü–†–û–í–ï–†–ö–ê –ó–î–û–†–û–í–¨–Ø –¥–∞—Ç—á–∏–∫–∞
if (sensor_manager_is_sensor_healthy(SENSOR_TYPE_PH)) {
    ESP_LOGI(TAG, "pH sensor OK");
} else {
    ESP_LOGW(TAG, "pH sensor has issues!");
}

// ‚úÖ –ö–ê–õ–ò–ë–†–û–í–ö–ê —á–µ—Ä–µ–∑ API
sensor_manager_calibrate_ph(7.15, 7.00); // –∏–∑–º–µ—Ä–µ–Ω–æ 7.15, —ç—Ç–∞–ª–æ–Ω 7.00
```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏ —á–µ—Ä–µ–∑ pump_manager
```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä—è–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPIO
gpio_set_level(GPIO_PUMP_1, 1);
vTaskDelay(pdMS_TO_TICKS(5000));
gpio_set_level(GPIO_PUMP_1, 0);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ pump_manager
esp_err_t err = pump_manager_start_pump(PUMP_PH_DOWN, 5000);
if (err != ESP_OK) {
    ESP_LOGE(TAG, "Failed to start pump: %s", esp_err_to_name(err));
}
```

#### –†–∞–±–æ—Ç–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —á–µ—Ä–µ–∑ config_manager
```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å NVS
nvs_handle_t handle;
nvs_open("storage", NVS_READWRITE, &handle);
uint32_t value = 0;
nvs_get_u32(handle, "ph_target", &value);
nvs_close(handle);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ config_manager
uint32_t ph_target = 0;
esp_err_t err = config_manager_get_u32("ph_target", &ph_target);
if (err != ESP_OK) {
    ph_target = 700; // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
}
```

#### –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ notification_system
```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–æ–∑–¥–∞–Ω–∏–µ popup –Ω–∞–ø—Ä—è–º—É—é
lv_obj_t* popup = lv_obj_create(lv_scr_act());
lv_label_set_text(lv_obj_get_child(popup, 0), "–û—à–∏–±–∫–∞!");

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ notification_system
notification_system_show(
    "–ù–∞—Å–æ—Å pH Down –∑–∞–ø—É—â–µ–Ω",
    NOTIFICATION_INFO,
    3000  // 3 —Å–µ–∫—É–Ω–¥—ã
);

notification_system_show(
    "–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞!",
    NOTIFICATION_ERROR,
    5000
);
```

#### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤ —á–µ—Ä–µ–∑ screen_manager
```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ —ç–∫—Ä–∞–Ω–∞
lv_obj_t* new_screen = create_my_screen();
lv_scr_load(new_screen);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ screen_manager
esp_err_t err = screen_manager_show("settings_screen");
if (err != ESP_OK) {
    ESP_LOGE(TAG, "Failed to show screen");
}

// –ò–ª–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
void* params = get_screen_params();
screen_manager_show_with_params("pid_detail_screen", params);
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ error_handler
```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º
if (sensor_read_failed) {
    ESP_LOGE(TAG, "Sensor failed");
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ error_handler
esp_err_t err = sensor_read();
if (err != ESP_OK) {
    error_handler_report(
        ERROR_SENSOR_READ_FAILED,
        SEVERITY_WARNING,
        "SHT3X sensor read failed"
    );
}
```

---

## üéØ –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–ê–¢–¢–ï–†–ù–´

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ app_main()

```c
void app_main(void) {
    ESP_LOGI(TAG, "=== Hydro System Starting ===");
    
    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    error_handler_init();
    config_manager_init();
    
    // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
    pump_manager_init();
    task_scheduler_init();
    
    // 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI
    lvgl_init();
    screen_manager_init();
    notification_system_init();
    
    // 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ –∏ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏
    sensor_manager_init();
    
    // 5. –ó–∞–ø—É—Å–∫ –∑–∞–¥–∞—á
    xTaskCreate(main_control_task, "main_ctrl", 8192, NULL, 5, NULL);
    
    ESP_LOGI(TAG, "=== System Ready ===");
}
```

### –û–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

```c
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
float global_ph_value = 7.0;

void sensor_task(void* arg) {
    global_ph_value = read_ph();  // –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!
}

void display_task(void* arg) {
    show_ph(global_ph_value);  // –ú–æ–∂–µ—Ç –±—ã—Ç—å race condition!
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —á–µ—Ä–µ–∑ getter —Ñ—É–Ω–∫—Ü–∏–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
// –í sensor_manager.c:
static float current_ph = 0.0;
static SemaphoreHandle_t ph_mutex = NULL;

esp_err_t sensor_manager_get_ph(float* out_ph) {
    if (xSemaphoreTake(ph_mutex, pdMS_TO_TICKS(100)) == pdTRUE) {
        *out_ph = current_ph;
        xSemaphoreGive(ph_mutex);
        return ESP_OK;
    }
    return ESP_ERR_TIMEOUT;
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
float ph = 0.0;
if (sensor_manager_get_ph(&ph) == ESP_OK) {
    show_ph(ph);
}
```

---

## üí° –£–õ–£–ß–®–ï–ù–ò–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–´

### ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –ú–ï–ù–ï–î–ñ–ï–†–´:

#### 1. **sensor_manager** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù (16.10.2025)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç!

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
```c
esp_err_t sensor_manager_init(void);
esp_err_t sensor_manager_read_all(sensor_data_t *data);
esp_err_t sensor_manager_get_cached_data(sensor_data_t *data);
esp_err_t sensor_manager_read_ph(float *ph);
esp_err_t sensor_manager_read_ec(float *ec);
bool sensor_manager_is_sensor_healthy(sensor_type_t sensor);
esp_err_t sensor_manager_calibrate_ph(float measured, float actual);
```

**–ß—Ç–æ –¥–∞–µ—Ç:**
- ‚úÖ Retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ)
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è (NaN, –¥–∏–∞–ø–∞–∑–æ–Ω)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –¥–∞—Ç—á–∏–∫–æ–≤
- ‚úÖ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ API
- ‚úÖ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–°–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** `SENSOR_MANAGER_INTEGRATION_REPORT.md`

---

### üîú –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –ú–ï–ù–ï–î–ñ–ï–†–´ (–µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã):

#### 2. **relay_manager** (–í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–ª–µ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `trema_relay` –Ω–∞–ø—Ä—è–º—É—é.

**–†–µ—à–µ–Ω–∏–µ:**
```c
// components/relay_manager/relay_manager.h

typedef enum {
    RELAY_LIGHT = 0,
    RELAY_FAN = 1,
    RELAY_HEATER = 2,
    RELAY_RESERVE = 3
} relay_channel_t;

esp_err_t relay_manager_init(void);
esp_err_t relay_manager_set(relay_channel_t relay, bool state);
esp_err_t relay_manager_toggle(relay_channel_t relay);
bool relay_manager_get_state(relay_channel_t relay);
esp_err_t relay_manager_schedule(relay_channel_t relay, const char *cron);
esp_err_t relay_manager_get_stats(relay_channel_t relay, relay_stats_t *stats);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ cron
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `task_scheduler`

---

#### 3. **calibration_manager** (–°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:**
```c
// components/calibration_manager/calibration_manager.h

esp_err_t calibration_manager_init(void);
esp_err_t calibration_manager_start_ph(float known_value);
esp_err_t calibration_manager_add_point(sensor_type_t sensor, float measured, float actual);
esp_err_t calibration_manager_finish(sensor_type_t sensor);
esp_err_t calibration_manager_apply_correction(sensor_type_t sensor, float *value);
```

---

### üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:

1. ‚úÖ **sensor_manager** - –†–ï–ê–õ–ò–ó–û–í–ê–ù! (16.10.2025)
2. ‚è≥ **–í–´–°–û–ö–ò–ô:** relay_manager - —É–ª—É—á—à–∏—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–µ
3. ‚è≥ **–°–†–ï–î–ù–ò–ô:** calibration_manager - —É–ø—Ä–æ—Å—Ç–∏—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫—É
4. ‚è≥ **–ù–ò–ó–ö–ò–ô:** recipe_manager - —É–¥–æ–±—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä
5. ‚è≥ **–ù–ò–ó–ö–ò–ô:** alert_manager - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤

**–°–º. –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** `–ê–†–•–ò–¢–ï–ö–¢–£–†–ê_–ü–†–û–ï–ö–¢–ê_–î–ï–¢–ê–õ–¨–ù–û.md`  
**–û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** `SENSOR_MANAGER_INTEGRATION_REPORT.md`

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–ê–ô–õ–´ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò

1. **–í–ï–†–°–ò–ò_–ö–û–ú–ü–û–ù–ï–ù–¢–û–í.md** - –í–µ—Ä—Å–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ ‚≠ê NEW!
2. **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê_–ü–†–û–ï–ö–¢–ê_–î–ï–¢–ê–õ–¨–ù–û.md** - –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ —Å API –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. **SENSOR_MANAGER_INTEGRATION_REPORT.md** - –û—Ç—á–µ—Ç –æ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ sensor_manager ‚≠ê NEW!
4. **BUILD_FLASH_MONITOR_ALGORITHM.md** - –ê–ª–≥–æ—Ä–∏—Ç–º —Å–±–æ—Ä–∫–∏ –∏ –ø—Ä–æ—à–∏–≤–∫–∏
5. **ADAPTIVE_PID_USER_GUIDE.md** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–º—É PID
6. **components/error_handler/ERROR_CODES_RU.md** - –ö–æ–¥—ã –æ—à–∏–±–æ–∫

---

**–£–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º! üöÄ‚ú®**

**–ü—Ä–æ–µ–∫—Ç —É–∂–µ –∏–º–µ–µ—Ç –û–¢–õ–ò–ß–ù–£–Æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏!**  
**–°–ª–µ–¥—É–π –ø—Ä–∞–≤–∏–ª–∞–º - —Ä–∞–±–æ—Ç–∞–π —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä—ã, –∏ –≤—Å—ë –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–æ!** ‚ú®


